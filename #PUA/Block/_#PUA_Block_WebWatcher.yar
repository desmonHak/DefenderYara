
rule _#PUA_Block_WebWatcher{
	meta:
		description = "!#PUA:Block:WebWatcher,SIGNATURE_TYPE_PEHSTR_EXT,06 00 06 00 09 00 00 "
		
	strings :
		$a_80_0 = {77 65 62 77 61 74 63 68 65 72 6e 6f 77 } //webwatchernow  1
		$a_80_1 = {41 57 49 6e 73 74 61 6c 6c 65 72 2e 70 64 62 } //AWInstaller.pdb  1
		$a_80_2 = {73 76 63 2e 77 65 62 77 61 74 63 68 65 72 64 61 74 61 2e 63 6f 6d 2f 76 35 31 2f 44 6c 70 2e 61 73 6d 78 } //svc.webwatcherdata.com/v51/Dlp.asmx  1
		$a_80_3 = {57 65 62 57 61 74 63 68 65 72 4d 61 63 45 55 4c 41 2e 72 74 66 } //WebWatcherMacEULA.rtf  1
		$a_80_4 = {36 35 62 33 66 64 65 32 2d 30 36 32 35 2d 34 61 61 39 2d 62 31 35 33 2d 36 37 37 37 61 36 62 36 37 39 35 61 } //65b3fde2-0625-4aa9-b153-6777a6b6795a  1
		$a_80_5 = {3f 53 65 6e 64 48 74 74 70 52 65 71 75 65 73 74 40 43 50 72 6f 78 79 40 40 43 41 4b 50 42 47 47 30 50 41 50 41 45 50 41 4b 50 41 58 4b 32 30 50 41 50 41 50 42 47 48 48 48 40 5a } //?SendHttpRequest@CProxy@@CAKPBGG0PAPAEPAKPAXK20PAPAPBGHHH@Z  1
		$a_80_6 = {55 6e 69 6e 73 74 2e 65 78 65 } //Uninst.exe  -100
		$a_80_7 = {55 6e 69 6e 73 74 61 6c 6c 65 72 2e 65 78 65 } //Uninstaller.exe  -100
		$a_80_8 = {55 6e 69 6e 73 74 61 6c 2e 65 78 65 } //Uninstal.exe  -100
	condition:
		((#a_80_0  & 1)*1+(#a_80_1  & 1)*1+(#a_80_2  & 1)*1+(#a_80_3  & 1)*1+(#a_80_4  & 1)*1+(#a_80_5  & 1)*1+(#a_80_6  & 1)*-100+(#a_80_7  & 1)*-100+(#a_80_8  & 1)*-100) >=6
 
}
rule _#PUA_Block_WebWatcher_2{
	meta:
		description = "!#PUA:Block:WebWatcher,SIGNATURE_TYPE_PEHSTR_EXT,06 00 06 00 08 00 00 "
		
	strings :
		$a_80_0 = {47 65 74 55 73 65 72 4f 62 6a 65 63 74 49 6e 66 6f 72 6d 61 74 69 6f 6e 41 } //GetUserObjectInformationA  1
		$a_80_1 = {47 65 74 55 73 65 72 44 65 66 61 75 6c 74 4c 43 49 44 } //GetUserDefaultLCID  1
		$a_80_2 = {46 69 72 65 46 6f 78 20 4d 6f 6e 69 74 6f 72 } //FireFox Monitor  1
		$a_02_3 = {75 00 73 00 65 00 72 00 5f 00 70 00 72 00 65 00 66 00 [0-12] 78 00 70 00 69 00 6e 00 73 00 74 00 61 00 6c 00 6c 00 2e 00 73 00 69 00 67 00 6e 00 61 00 74 00 75 00 72 00 65 00 73 00 2e 00 72 00 65 00 71 00 75 00 69 00 72 00 65 00 64 00 } //1
		$a_02_4 = {75 73 65 72 5f 70 72 65 66 [0-12] 78 70 69 6e 73 74 61 6c 6c 2e 73 69 67 6e 61 74 75 72 65 73 2e 72 65 71 75 69 72 65 64 } //1
		$a_02_5 = {75 00 73 00 65 00 72 00 5f 00 70 00 72 00 65 00 66 00 [0-12] 65 00 78 00 74 00 65 00 6e 00 73 00 69 00 6f 00 6e 00 73 00 2e 00 62 00 6f 00 6f 00 74 00 73 00 74 00 72 00 61 00 70 00 70 00 65 00 64 00 41 00 64 00 64 00 6f 00 6e 00 73 00 } //1
		$a_02_6 = {75 73 65 72 5f 70 72 65 66 [0-12] 65 78 74 65 6e 73 69 6f 6e 73 2e 62 6f 6f 74 73 74 72 61 70 70 65 64 41 64 64 6f 6e 73 } //1
		$a_80_7 = {52 65 63 6f 72 64 73 20 61 6c 6c 20 77 65 62 73 69 74 65 73 20 76 69 73 69 74 65 64 20 61 6e 64 20 63 61 70 74 75 72 65 73 20 48 6f 74 6d 61 69 6c 2c 20 59 61 68 6f 6f 21 20 4d 61 69 6c } //Records all websites visited and captures Hotmail, Yahoo! Mail  1
	condition:
		((#a_80_0  & 1)*1+(#a_80_1  & 1)*1+(#a_80_2  & 1)*1+(#a_02_3  & 1)*1+(#a_02_4  & 1)*1+(#a_02_5  & 1)*1+(#a_02_6  & 1)*1+(#a_80_7  & 1)*1) >=6
 
}
rule _#PUA_Block_WebWatcher_3{
	meta:
		description = "!#PUA:Block:WebWatcher,SIGNATURE_TYPE_PEHSTR,03 00 03 00 06 00 00 "
		
	strings :
		$a_01_0 = {57 65 62 57 61 74 63 68 65 72 4d 61 63 45 55 4c 41 2e 72 74 66 } //1 WebWatcherMacEULA.rtf
		$a_01_1 = {40 41 77 61 72 65 6e 65 73 73 20 54 65 63 68 6e 6f 6c 6f 67 69 65 73 64 } //1 @Awareness Technologiesd
		$a_01_2 = {43 41 57 49 6e 73 74 61 6c 6c 65 72 3a 20 52 65 6d 6f 76 65 43 68 72 6f 6d 65 45 78 74 65 6e 73 69 6f 6e } //1 CAWInstaller: RemoveChromeExtension
		$a_01_3 = {41 57 49 6e 73 74 61 6c 6c 65 72 2e 70 64 62 } //1 AWInstaller.pdb
		$a_01_4 = {64 61 74 61 2e 77 65 62 77 61 74 63 68 65 72 64 61 74 61 2e 63 6f 6d } //1 data.webwatcherdata.com
		$a_01_5 = {52 65 6c 65 61 73 65 20 44 6c 70 48 6f 6f 6b 5c 50 72 6f 78 79 2e 70 64 62 } //1 Release DlpHook\Proxy.pdb
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1) >=3
 
}