
rule Trojan_BAT_Heracles_AHC_MTB{
	meta:
		description = "Trojan:BAT/Heracles.AHC!MTB,SIGNATURE_TYPE_PEHSTR_EXT,02 00 02 00 01 00 00 "
		
	strings :
		$a_03_0 = {16 2d 18 08 09 18 5b 06 09 18 6f ?? ?? ?? 0a 1f 10 28 ?? ?? ?? 0a 9c 09 18 58 0d 09 07 32 e1 } //2
	condition:
		((#a_03_0  & 1)*2) >=2
 
}
rule Trojan_BAT_Heracles_AHC_MTB_2{
	meta:
		description = "Trojan:BAT/Heracles.AHC!MTB,SIGNATURE_TYPE_PEHSTR_EXT,01 00 01 00 01 00 00 "
		
	strings :
		$a_03_0 = {0a 0d 00 09 08 16 73 ?? ?? ?? 0a 13 04 00 73 ?? ?? ?? 0a 13 05 00 11 04 11 05 6f ?? ?? ?? 0a 00 11 05 6f ?? ?? ?? 0a 0a 00 de 14 11 05 14 fe 01 13 07 11 07 2d 08 11 05 } //1
	condition:
		((#a_03_0  & 1)*1) >=1
 
}
rule Trojan_BAT_Heracles_AHC_MTB_3{
	meta:
		description = "Trojan:BAT/Heracles.AHC!MTB,SIGNATURE_TYPE_PEHSTR_EXT,41 00 41 00 04 00 00 "
		
	strings :
		$a_01_0 = {03 20 00 01 00 00 5d 20 00 01 00 00 58 20 00 01 00 00 5d 10 01 02 03 58 20 00 01 00 00 5d d2 } //30
		$a_01_1 = {73 65 74 5f 52 61 74 50 69 64 } //20 set_RatPid
		$a_01_2 = {44 6f 52 65 6d 6f 76 65 57 69 6e 52 45 50 65 72 73 69 73 74 65 6e 63 65 } //10 DoRemoveWinREPersistence
		$a_01_3 = {57 72 69 74 65 4f 62 66 75 73 63 61 74 65 64 4c 6f 67 46 69 6c 65 } //5 WriteObfuscatedLogFile
	condition:
		((#a_01_0  & 1)*30+(#a_01_1  & 1)*20+(#a_01_2  & 1)*10+(#a_01_3  & 1)*5) >=65
 
}
rule Trojan_BAT_Heracles_AHC_MTB_4{
	meta:
		description = "Trojan:BAT/Heracles.AHC!MTB,SIGNATURE_TYPE_PEHSTR_EXT,03 00 03 00 02 00 00 "
		
	strings :
		$a_03_0 = {0d 2b 61 09 6f ?? ?? ?? 0a 13 04 12 04 28 ?? ?? ?? 0a 6f ?? ?? ?? 0a 72 27 00 00 70 16 28 ?? ?? ?? 0a 2c 40 72 33 00 00 70 13 05 12 04 28 ?? ?? ?? 0a 11 05 16 28 ?? ?? ?? 0a 16 31 27 02 6f ?? ?? ?? 06 6f ?? ?? ?? 0a 12 04 28 ?? ?? ?? 0a 11 05 72 a9 00 00 70 17 15 16 28 } //2
		$a_01_1 = {44 00 69 00 73 00 63 00 6f 00 72 00 64 00 3a 00 20 00 44 00 69 00 61 00 72 00 74 00 69 00 6f 00 73 00 23 00 35 00 38 00 35 00 30 00 } //1 Discord: Diartios#5850
	condition:
		((#a_03_0  & 1)*2+(#a_01_1  & 1)*1) >=3
 
}