
rule Trojan_BAT_SnakeKeyLogger_AB_MTB{
	meta:
		description = "Trojan:BAT/SnakeKeyLogger.AB!MTB,SIGNATURE_TYPE_PEHSTR_EXT,02 00 02 00 02 00 00 "
		
	strings :
		$a_03_0 = {0a 02 02 8e 69 17 59 91 1f 70 61 0b 02 8e 69 17 58 8d ?? ?? ?? 01 0c 16 } //1
		$a_03_1 = {02 11 04 91 07 61 06 09 91 61 13 05 08 11 04 11 05 d2 9c 09 03 6f ?? ?? ?? 0a [0-03] 58 [0-03] 59 fe 01 13 06 11 06 2c 04 16 0d 2b ?? 09 [0-03] 58 [0-04] 0d 00 11 04 17 58 13 04 11 04 02 8e 69 17 59 [0-08] fe 02 16 fe 01 13 07 11 07 2d } //1
	condition:
		((#a_03_0  & 1)*1+(#a_03_1  & 1)*1) >=2
 
}
rule Trojan_BAT_SnakeKeyLogger_AB_MTB_2{
	meta:
		description = "Trojan:BAT/SnakeKeyLogger.AB!MTB,SIGNATURE_TYPE_PEHSTR_EXT,0c 00 0c 00 03 00 00 "
		
	strings :
		$a_01_0 = {16 13 09 00 08 11 09 58 07 61 13 0a 11 0a 17 5f 16 fe 01 13 0d 11 0d 2c 07 00 07 11 0a 61 0b 00 02 08 11 09 6f 92 00 00 0a 13 0b 04 03 6f 93 00 00 0a 59 13 0c 11 0c 16 fe 01 13 0e 11 0e 2c 06 00 38 9a 00 00 00 11 0c 17 fe 01 13 0f 11 0f 2c 12 00 03 12 0b 28 94 00 00 0a 6f 95 00 00 0a 00 00 2b 57 11 0c 18 fe 01 13 10 } //6
		$a_01_1 = {28 94 00 00 0a 6f 95 00 00 0a 00 03 12 0b 28 96 00 00 0a 6f 95 00 00 0a 00 03 12 0b 28 97 00 00 0a 6f 95 00 00 0a 00 00 11 09 17 58 13 09 00 11 09 02 6f 98 00 00 0a 2f 0b 03 6f 93 00 00 0a 04 fe 04 } //4
		$a_01_2 = {24 30 34 31 30 63 39 36 66 2d 62 32 31 38 2d 34 37 35 37 2d 61 62 37 34 2d 32 63 64 38 30 34 31 38 36 36 36 32 } //2 $0410c96f-b218-4757-ab74-2cd804186662
	condition:
		((#a_01_0  & 1)*6+(#a_01_1  & 1)*4+(#a_01_2  & 1)*2) >=12
 
}