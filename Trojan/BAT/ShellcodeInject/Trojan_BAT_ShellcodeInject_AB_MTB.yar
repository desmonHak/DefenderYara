
rule Trojan_BAT_ShellcodeInject_AB_MTB{
	meta:
		description = "Trojan:BAT/ShellcodeInject.AB!MTB,SIGNATURE_TYPE_PEHSTR_EXT,0b 00 0b 00 05 00 00 "
		
	strings :
		$a_01_0 = {16 0b 2b 15 00 06 07 03 07 91 04 07 04 8e 69 5d 91 61 d2 9c 00 07 17 58 0b 07 03 8e 69 fe 04 0d 09 2d e1 } //5
		$a_03_1 = {75 74 69 6c 69 74 79 [0-2f] 5f 75 70 6c 6f 61 64 5f 69 6d 61 67 65 5f 32 30 32 35 [30-39] [30-39] [30-39] [0 04 19 0] [0 04 19 0] [0 04 19 0] [0 04 19 0] [0 04 19 0] [0 04 19 0] [0 04 19 0] [0 04 19 0] [0 04 19 0] [0 04 19 0] [0 04 19 0] [0 04 19 0] [0 04 19 0] [0 04 19 0] [0 04 19 0] [0 04 19 0] [0 04 19 0] [0 04 19 0] [0 04 19 0] [0 04 19 0] [0 04 19 0] [0 04 19 0] [0 04 19 0] [0 04 19 0] [0 04 19 0] 3 30 2d 39 5f 61 73 70 78 } //2
		$a_03_2 = {41 70 70 5f 57 65 62 5f 90 04 08 06 61 2d 7a 30 2d 39 2e 64 6c 6c } //2
		$a_81_3 = {6e 6f 74 65 70 61 64 2e 65 78 65 } //1 notepad.exe
		$a_81_4 = {57 72 69 74 65 50 72 6f 63 65 73 73 4d 65 6d 6f 72 79 } //1 WriteProcessMemory
	condition:
		((#a_01_0  & 1)*5+(#a_03_1  & 1)*2+(#a_03_2  & 1)*2+(#a_81_3  & 1)*1+(#a_81_4  & 1)*1) >=11
 
}