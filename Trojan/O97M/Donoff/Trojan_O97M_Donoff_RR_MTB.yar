
rule Trojan_O97M_Donoff_RR_MTB{
	meta:
		description = "Trojan:O97M/Donoff.RR!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,02 00 02 00 02 00 00 "
		
	strings :
		$a_03_0 = {76 62 61 2e 65 6e 76 69 72 6f 6e 28 22 61 6c 22 26 22 6c 75 73 65 22 26 22 72 73 70 72 22 26 22 6f 66 69 6c 65 22 29 26 22 2f 63 73 22 26 22 63 75 69 2e 64 22 26 22 6c 6c 22 [0-0a] 3d 76 62 61 2e 65 6e 76 69 72 6f 6e 28 22 75 73 65 22 26 22 72 70 72 22 26 22 6f 66 69 6c 65 22 29 26 22 2f 70 69 63 22 26 22 74 75 72 65 73 2f 6b 22 26 22 6f 22 26 22 61 22 26 22 6c 22 26 22 61 2e 70 22 26 22 6e 67 22 } //1
		$a_01_1 = {76 62 61 2e 65 6e 76 69 72 6f 6e 28 22 77 69 22 26 22 6e 64 22 26 22 69 72 22 29 26 22 2f 73 79 22 26 22 73 74 65 6d 33 22 26 22 32 2f 72 22 26 22 75 6e 64 6c 22 26 22 6c 33 32 2e 65 22 26 22 78 65 } //1 vba.environ("wi"&"nd"&"ir")&"/sy"&"stem3"&"2/r"&"undl"&"l32.e"&"xe
	condition:
		((#a_03_0  & 1)*1+(#a_01_1  & 1)*1) >=2
 
}