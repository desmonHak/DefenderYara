
rule Trojan_Win64_Zusy_NIT_MTB{
	meta:
		description = "Trojan:Win64/Zusy.NIT!MTB,SIGNATURE_TYPE_PEHSTR_EXT,02 00 02 00 02 00 00 "
		
	strings :
		$a_03_0 = {48 8d ac 24 ?? ?? ff ff 48 81 ec ?? ?? ?? ?? 48 8b 05 43 12 02 00 48 33 c4 48 89 85 ?? ?? ?? ?? 4d 8b e0 48 8b f9 48 bb ?? ?? ?? ?? ?? ?? ?? ?? 48 3b d1 74 22 8a 02 2c 2f 3c 2d 77 0a 48 0f be c0 48 0f a3 c3 72 10 48 8b cf e8 d2 ?? ?? ?? 48 8b d0 48 3b c7 75 de } //2
		$a_03_1 = {b8 40 41 00 00 66 c1 e3 07 b9 80 00 00 00 66 f7 d3 66 23 d9 66 0b d8 4d 85 c0 74 5f 8d 51 ae 49 8b c8 e8 17 1f 01 00 48 8b f0 48 85 c0 74 4c 48 8d 15 ?? ?? ?? ?? 48 8b c8 e8 1c 78 00 00 85 c0 74 3c 48 8d 15 ?? ?? ?? ?? 48 8b ce e8 09 78 00 00 85 c0 74 29 48 8d 15 ?? ?? ?? ?? 48 8b ce e8 f6 77 00 00 85 c0 74 16 48 8d 15 ?? ?? ?? ?? 48 8b ce e8 e3 77 00 00 85 c0 74 03 40 8a fd 48 8b 6c 24 38 0f b7 c3 48 8b 74 24 40 66 83 c8 40 40 84 ff } //3
	condition:
		((#a_03_0  & 1)*2+(#a_03_1  & 1)*3) >=2
 
}
rule Trojan_Win64_Zusy_NIT_MTB_2{
	meta:
		description = "Trojan:Win64/Zusy.NIT!MTB,SIGNATURE_TYPE_PEHSTR_EXT,08 00 08 00 05 00 00 "
		
	strings :
		$a_01_0 = {48 8b 44 24 30 48 8b 4c 24 30 48 ff c9 48 89 4c 24 30 48 85 c0 74 2b 48 8b 44 24 20 48 8b 4c 24 28 0f b6 09 88 08 48 8b 44 24 20 48 ff c0 48 89 44 24 20 48 8b 44 24 28 48 ff c0 48 89 44 24 28 eb be } //2
		$a_01_1 = {48 8b 04 24 0f be 00 48 8b 0c 24 48 ff c1 48 89 0c 24 85 c0 74 0c 48 8b 44 24 20 48 89 44 24 20 eb de } //2
		$a_01_2 = {4c 8b dc 48 81 ec 88 02 00 00 48 8b 05 b7 d9 00 00 48 89 84 24 70 02 00 00 49 89 5b 10 49 89 73 18 48 8d 4c 24 50 33 d2 41 b8 04 01 00 00 49 89 7b 20 e8 c9 46 00 00 48 8d 8c 24 60 01 00 00 33 d2 41 b8 04 01 00 00 e8 b4 46 00 00 48 8d 4c 24 50 ba 04 01 00 00 ff 15 4c d8 ff ff 33 c0 48 8d 7c 24 50 48 c7 c1 ff ff ff ff 48 8d 1d 2f e3 00 00 f2 ae 48 8b 05 26 de ff ff 33 f6 48 89 47 ff 8b 05 22 de ff ff 48 8b ce 89 47 07 0f b7 05 19 de ff ff 66 89 47 0b 0f b6 05 10 de ff ff 88 47 0d } //2
		$a_01_3 = {46 69 6e 64 46 69 72 73 74 46 69 6c 65 28 69 6e 66 29 } //1 FindFirstFile(inf)
		$a_01_4 = {52 65 6d 6f 76 65 3a 20 25 73 20 73 75 63 63 65 73 73 21 } //1 Remove: %s success!
	condition:
		((#a_01_0  & 1)*2+(#a_01_1  & 1)*2+(#a_01_2  & 1)*2+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1) >=8
 
}