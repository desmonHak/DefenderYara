
rule Trojan_Win64_Convagent_AHC_MTB{
	meta:
		description = "Trojan:Win64/Convagent.AHC!MTB,SIGNATURE_TYPE_PEHSTR_EXT,23 00 23 00 03 00 00 "
		
	strings :
		$a_01_0 = {48 c7 84 24 70 01 00 00 2e 00 00 00 48 c7 84 24 78 01 00 00 64 00 00 00 48 c7 84 24 80 01 00 00 6c 00 00 00 48 c7 84 24 88 01 00 00 6c 00 00 00 48 8d 05 } //20
		$a_00_1 = {48 c7 84 24 18 03 00 00 63 00 00 00 48 c7 84 24 20 03 00 00 65 00 00 00 48 c7 84 24 28 03 00 00 73 00 00 00 48 c7 84 24 30 03 00 00 41 00 00 00 48 8d 05 } //10
		$a_00_2 = {6d 61 69 6e 2e 67 65 74 4f 62 66 75 73 63 61 74 65 64 53 68 65 6c 6c 63 6f 64 65 } //5 main.getObfuscatedShellcode
	condition:
		((#a_01_0  & 1)*20+(#a_00_1  & 1)*10+(#a_00_2  & 1)*5) >=35
 
}