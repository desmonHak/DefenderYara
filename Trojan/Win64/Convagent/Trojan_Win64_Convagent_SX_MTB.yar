
rule Trojan_Win64_Convagent_SX_MTB{
	meta:
		description = "Trojan:Win64/Convagent.SX!MTB,SIGNATURE_TYPE_PEHSTR_EXT,1f 00 1f 00 05 00 00 "
		
	strings :
		$a_01_0 = {c6 84 24 c8 01 00 00 53 c6 84 24 c9 01 00 00 68 c6 84 24 ca 01 00 00 65 c6 84 24 cb 01 00 00 6c c6 84 24 cc 01 00 00 6c c6 84 24 cd 01 00 00 45 c6 84 24 ce 01 00 00 78 c6 84 24 cf 01 00 00 65 c6 84 24 d0 01 00 00 63 c6 84 24 d1 01 00 00 75 c6 84 24 d2 01 00 00 74 c6 84 24 d3 01 00 00 65 c6 84 24 d4 01 00 00 45 c6 84 24 d5 01 00 00 78 c6 84 24 d6 01 00 00 41 } //20
		$a_03_1 = {48 03 c8 48 8b c1 48 89 44 24 60 48 8b 94 24 88 00 00 00 48 8b 4c 24 60 ff 15 ?? ?? ?? ?? 85 c0 75 37 8b 44 24 58 48 8b 4c 24 48 } //10
		$a_80_2 = {41 63 74 69 6f 6e 51 75 65 75 65 2e 44 4c 4c 2e 4d 55 49 } //ActionQueue.DLL.MUI  1
		$a_80_3 = {63 64 70 72 74 2e 64 6c 6c 2e 6d 75 69 } //cdprt.dll.mui  1
		$a_80_4 = {6c 6f 63 61 6c 73 65 63 2e 64 6c 6c 2e 6d 75 69 } //localsec.dll.mui  1
	condition:
		((#a_01_0  & 1)*20+(#a_03_1  & 1)*10+(#a_80_2  & 1)*1+(#a_80_3  & 1)*1+(#a_80_4  & 1)*1) >=31
 
}