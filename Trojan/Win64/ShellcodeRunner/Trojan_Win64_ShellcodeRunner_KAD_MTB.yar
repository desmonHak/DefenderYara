
rule Trojan_Win64_ShellcodeRunner_KAD_MTB{
	meta:
		description = "Trojan:Win64/ShellcodeRunner.KAD!MTB,SIGNATURE_TYPE_PEHSTR_EXT,01 00 01 00 01 00 00 "
		
	strings :
		$a_03_0 = {41 89 d0 41 29 c0 41 8d 40 ?? 66 31 01 83 c2 } //1
	condition:
		((#a_03_0  & 1)*1) >=1
 
}
rule Trojan_Win64_ShellcodeRunner_KAD_MTB_2{
	meta:
		description = "Trojan:Win64/ShellcodeRunner.KAD!MTB,SIGNATURE_TYPE_PEHSTR_EXT,23 00 23 00 04 00 00 "
		
	strings :
		$a_03_0 = {48 01 d0 44 0f b6 00 0f b6 0d ?? ?? 00 00 8b 55 ?? 48 8b 45 ?? 48 01 d0 44 89 c2 31 ca 88 10 83 45 } //20
		$a_03_1 = {48 98 48 8d 15 ?? ?? 00 00 88 0c 10 8b 45 ?? 48 98 48 8d 15 ?? ?? 00 00 0f b6 04 10 83 f0 ?? 89 c1 8b 45 } //10
		$a_01_2 = {46 69 72 73 74 20 31 36 20 62 79 74 65 73 20 6f 66 20 64 65 63 72 79 70 74 65 64 20 73 68 65 6c 6c 63 6f 64 65 3a } //5 First 16 bytes of decrypted shellcode:
		$a_01_3 = {53 68 65 6c 6c 63 6f 64 65 20 65 78 65 63 75 74 65 64 } //5 Shellcode executed
	condition:
		((#a_03_0  & 1)*20+(#a_03_1  & 1)*10+(#a_01_2  & 1)*5+(#a_01_3  & 1)*5) >=35
 
}