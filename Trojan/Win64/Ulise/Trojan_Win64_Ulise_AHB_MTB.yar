
rule Trojan_Win64_Ulise_AHB_MTB{
	meta:
		description = "Trojan:Win64/Ulise.AHB!MTB,SIGNATURE_TYPE_PEHSTR_EXT,3c 00 3c 00 03 00 00 "
		
	strings :
		$a_01_0 = {c6 85 8a 00 00 00 48 c6 85 8b 00 00 00 83 c6 85 8c 00 00 00 c4 c6 85 8d 00 00 00 28 c6 85 8e 00 00 00 c3 } //30
		$a_01_1 = {44 65 63 72 79 70 74 69 6e 67 20 44 4c 4c 20 77 69 74 68 20 58 4f 52 20 6b 65 79 } //20 Decrypting DLL with XOR key
		$a_01_2 = {5b 4b 65 79 47 65 74 5d 20 52 65 66 6c 65 63 74 69 76 65 20 69 6e 6a 65 63 74 69 6f 6e 20 73 75 63 63 65 73 73 66 75 6c } //10 [KeyGet] Reflective injection successful
	condition:
		((#a_01_0  & 1)*30+(#a_01_1  & 1)*20+(#a_01_2  & 1)*10) >=60
 
}