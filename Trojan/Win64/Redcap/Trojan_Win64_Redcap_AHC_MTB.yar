
rule Trojan_Win64_Redcap_AHC_MTB{
	meta:
		description = "Trojan:Win64/Redcap.AHC!MTB,SIGNATURE_TYPE_PEHSTR_EXT,64 00 64 00 04 00 00 "
		
	strings :
		$a_03_0 = {48 29 d1 48 ff c9 48 89 4c 24 50 48 89 ce 48 f7 d9 48 c1 f9 ?? 48 8b bc 24 80 00 00 00 48 21 cf 48 8b 8c 24 98 01 00 00 48 01 cf } //10
		$a_01_1 = {63 32 2d 61 67 65 6e 74 2f 69 6e 74 65 72 6e 61 6c 2f 65 76 61 73 69 6f 6e 2e 50 61 74 63 68 41 4d 53 49 } //20 c2-agent/internal/evasion.PatchAMSI
		$a_01_2 = {63 32 2d 61 67 65 6e 74 2f 69 6e 74 65 72 6e 61 6c 2f 6f 62 66 75 73 63 61 74 6f 72 2e 69 6e 69 74 } //30 c2-agent/internal/obfuscator.init
		$a_01_3 = {63 32 2d 61 67 65 6e 74 2f 69 6e 74 65 72 6e 61 6c 2f 63 72 79 70 74 6f 2e 47 65 74 43 6c 65 61 6e 41 67 65 6e 74 49 44 } //40 c2-agent/internal/crypto.GetCleanAgentID
	condition:
		((#a_03_0  & 1)*10+(#a_01_1  & 1)*20+(#a_01_2  & 1)*30+(#a_01_3  & 1)*40) >=100
 
}