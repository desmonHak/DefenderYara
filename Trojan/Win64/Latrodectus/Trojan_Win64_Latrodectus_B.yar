
rule Trojan_Win64_Latrodectus_B{
	meta:
		description = "Trojan:Win64/Latrodectus.B,SIGNATURE_TYPE_PEHSTR_EXT,30 01 30 01 0d 00 00 "
		
	strings :
		$a_01_0 = {69 00 0d 66 19 00 } //100
		$a_01_1 = {c7 04 24 c5 9d 1c 81 } //100
		$a_01_2 = {69 04 24 93 01 00 01 } //100
		$a_03_3 = {4d 5a 45 52 e8 00 00 00 00 59 48 83 e9 09 48 8b c1 48 05 ?? ?? ?? ?? ff d0 c3 } //10
		$a_03_4 = {4d 5a 45 52 e8 00 00 00 00 5b 48 83 eb 09 53 48 81 c3 ?? ?? ?? ?? ff d0 c3 } //10
		$a_03_5 = {4d 5a 45 52 e8 00 00 00 00 58 83 e8 09 50 05 ?? ?? ?? ?? ff d0 c3 } //10
		$a_01_6 = {b0 06 6a 90 } //1
		$a_01_7 = {87 b8 c9 d4 } //1
		$a_01_8 = {f6 b1 00 ff } //1
		$a_01_9 = {66 0f 38 1d e0 66 0f 6f c3 66 0f 6d c1 66 0f 6f } //1
		$a_03_10 = {8b 04 24 ff c0 89 04 24 8b 44 24 ?? 39 04 24 73 } //1
		$a_03_11 = {8b 0c 24 48 8b 54 24 ?? 0f b6 0c 0a 33 4c 24 ?? 81 e1 ?? ?? ?? ?? 8b c9 48 8d 15 ?? ?? ?? ?? 33 04 8a 89 44 24 ?? eb } //1
		$a_01_12 = {48 03 c8 48 8b c1 8b 4c 24 20 48 8d 04 88 48 89 44 24 38 48 8b 44 24 38 8b 00 48 8b 4c 24 70 48 03 c8 48 8b c1 48 89 44 24 28 48 8b 4c 24 28 } //1
	condition:
		((#a_01_0  & 1)*100+(#a_01_1  & 1)*100+(#a_01_2  & 1)*100+(#a_03_3  & 1)*10+(#a_03_4  & 1)*10+(#a_03_5  & 1)*10+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1+(#a_01_8  & 1)*1+(#a_01_9  & 1)*1+(#a_03_10  & 1)*1+(#a_03_11  & 1)*1+(#a_01_12  & 1)*1) >=304
 
}