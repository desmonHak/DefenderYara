
rule Trojan_Win64_Tedy_AHE_MTB{
	meta:
		description = "Trojan:Win64/Tedy.AHE!MTB,SIGNATURE_TYPE_PEHSTR_EXT,0f 00 0f 00 02 00 00 "
		
	strings :
		$a_01_0 = {c7 45 f7 4d 1e 51 17 c7 45 fb 06 16 55 05 c7 45 ff 4c 45 47 16 c7 45 03 42 5a 13 54 c6 45 07 6c 0f 57 c0 } //10
		$a_01_1 = {48 8d 4d 27 49 83 fa 0f 49 0f 47 c9 33 d2 48 8b c3 49 f7 f3 44 32 04 0a 48 8b c7 48 83 7f 18 0f 76 } //5
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*5) >=15
 
}
rule Trojan_Win64_Tedy_AHE_MTB_2{
	meta:
		description = "Trojan:Win64/Tedy.AHE!MTB,SIGNATURE_TYPE_PEHSTR_EXT,0f 00 0f 00 02 00 00 "
		
	strings :
		$a_01_0 = {41 f7 e1 45 0f b6 c0 41 8b c1 c1 ea 03 8d 0c 52 c1 e1 02 2b c1 48 63 c8 0f be 14 39 41 03 d3 44 03 c2 41 81 e0 } //10
		$a_01_1 = {48 63 d8 44 0f b6 54 1c 30 41 02 fa 40 0f b6 cf 0f b6 44 0c 30 88 44 1c 30 44 88 54 0c 30 44 0f b6 44 1c 30 4d 03 c2 41 0f b6 c0 44 0f b6 44 04 30 45 30 04 33 49 ff c3 49 81 fb } //5
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*5) >=15
 
}
rule Trojan_Win64_Tedy_AHE_MTB_3{
	meta:
		description = "Trojan:Win64/Tedy.AHE!MTB,SIGNATURE_TYPE_PEHSTR_EXT,46 00 46 00 03 00 00 "
		
	strings :
		$a_01_0 = {48 ba e5 59 29 8d 0f c6 6d 97 48 89 94 24 0e 02 00 00 48 ba 59 f0 95 59 ae 33 50 0c 48 89 94 24 16 02 00 00 48 ba b1 4d 2c 80 1d dd 70 c5 48 89 94 24 1e 02 00 00 } //20
		$a_01_1 = {48 8b 54 24 58 48 89 50 18 48 8b 54 24 20 48 89 50 20 48 8b 49 10 48 89 c3 } //40
		$a_00_2 = {6d 61 69 6e 2e 64 65 6f 62 66 75 73 63 61 74 65 53 68 65 6c 6c 63 6f 64 65 } //10 main.deobfuscateShellcode
	condition:
		((#a_01_0  & 1)*20+(#a_01_1  & 1)*40+(#a_00_2  & 1)*10) >=70
 
}