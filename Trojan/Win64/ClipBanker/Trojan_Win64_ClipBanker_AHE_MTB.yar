
rule Trojan_Win64_ClipBanker_AHE_MTB{
	meta:
		description = "Trojan:Win64/ClipBanker.AHE!MTB,SIGNATURE_TYPE_PEHSTR_EXT,ffffff96 00 ffffff96 00 05 00 00 "
		
	strings :
		$a_01_0 = {5b 44 45 42 55 47 5d 20 53 68 65 6c 6c 63 6f 64 65 20 77 72 69 74 74 65 6e 20 74 6f 20 72 65 6d 6f 74 65 20 70 72 6f 63 65 73 73 } //10 [DEBUG] Shellcode written to remote process
		$a_01_1 = {4d 61 73 74 65 72 20 6b 65 79 20 64 65 63 72 79 70 74 65 64 20 76 69 61 20 52 65 66 6c 65 63 74 69 76 65 20 44 4c 4c 20 49 6e 6a 65 63 74 69 6f 6e } //20 Master key decrypted via Reflective DLL Injection
		$a_01_2 = {5b 43 68 72 6f 6d 65 42 5d 20 44 65 74 65 63 74 65 64 20 41 42 45 20 65 6e 63 72 79 70 74 69 6f 6e 2c 20 75 73 69 6e 67 20 52 65 66 6c 65 63 74 69 76 65 20 44 4c 4c 20 49 6e 6a 65 63 74 69 6f 6e 2e 2e 2e } //30 [ChromeB] Detected ABE encryption, using Reflective DLL Injection...
		$a_01_3 = {5b 43 68 72 6f 6d 65 42 5d 20 57 61 6c 6c 65 74 20 65 78 74 72 61 63 74 69 6f 6e 20 63 6f 6d 70 6c 65 74 65 64 2e 20 46 6f 75 6e 64 } //40 [ChromeB] Wallet extraction completed. Found
		$a_01_4 = {5b 43 68 72 6f 6d 65 42 5d 20 4b 65 79 6c 6f 67 67 65 72 20 74 68 72 65 61 64 20 73 74 6f 70 70 65 64 } //50 [ChromeB] Keylogger thread stopped
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*20+(#a_01_2  & 1)*30+(#a_01_3  & 1)*40+(#a_01_4  & 1)*50) >=150
 
}