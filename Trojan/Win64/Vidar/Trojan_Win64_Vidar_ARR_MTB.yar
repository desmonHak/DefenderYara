
rule Trojan_Win64_Vidar_ARR_MTB{
	meta:
		description = "Trojan:Win64/Vidar.ARR!MTB,SIGNATURE_TYPE_PEHSTR_EXT,14 00 14 00 02 00 00 "
		
	strings :
		$a_01_0 = {46 8a 1c 12 45 30 c3 46 88 1c 11 41 bb } //15
		$a_03_1 = {41 0f be 55 00 49 ff c5 85 d2 41 b8 ?? ?? ?? ?? 44 0f 44 c3 eb ?? 41 89 c8 41 c1 e0 ?? 01 d1 44 01 c1 41 b8 } //5
	condition:
		((#a_01_0  & 1)*15+(#a_03_1  & 1)*5) >=20
 
}
rule Trojan_Win64_Vidar_ARR_MTB_2{
	meta:
		description = "Trojan:Win64/Vidar.ARR!MTB,SIGNATURE_TYPE_PEHSTR_EXT,14 00 14 00 03 00 00 "
		
	strings :
		$a_01_0 = {0f be d0 8b ce 0f af cd 8d 04 49 03 d0 } //10
		$a_01_1 = {8d 04 5a 41 03 c0 33 d2 f7 f1 44 8b c0 0f be 05 } //7
		$a_03_2 = {0f 57 c0 6b c3 ?? 03 c6 41 03 c0 f7 f1 44 8b c0 0f be 05 } //3
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*7+(#a_03_2  & 1)*3) >=20
 
}
rule Trojan_Win64_Vidar_ARR_MTB_3{
	meta:
		description = "Trojan:Win64/Vidar.ARR!MTB,SIGNATURE_TYPE_PEHSTR_EXT,14 00 14 00 04 00 00 "
		
	strings :
		$a_03_0 = {0f 57 c9 f2 48 0f 2a c9 f2 0f 59 c8 f2 0f 10 15 ?? ?? ?? ?? f2 0f 59 ca f2 0f 11 8c c4 } //5
		$a_01_1 = {48 8d 0c 89 0f 57 d2 f2 48 0f 2a d1 f2 0f 58 c2 48 ff c0 48 83 f8 } //10
		$a_81_2 = {6d 61 69 6e 2e 6d 61 69 6e 2e 66 75 6e 63 34 2e 6d 61 69 6e 2e 66 75 6e 63 34 2e 31 34 2e 32 33 2e 31 30 } //3 main.main.func4.main.func4.14.23.10
		$a_81_3 = {6d 61 69 6e 2e 6d 61 69 6e 2e 66 75 6e 63 31 2e 6d 61 69 6e 2e 66 75 6e 63 31 2e 31 34 2e 32 33 2e 31 32 } //2 main.main.func1.main.func1.14.23.12
	condition:
		((#a_03_0  & 1)*5+(#a_01_1  & 1)*10+(#a_81_2  & 1)*3+(#a_81_3  & 1)*2) >=20
 
}