
rule Trojan_Win64_CobaltStrike_NKC_MTB{
	meta:
		description = "Trojan:Win64/CobaltStrike.NKC!MTB,SIGNATURE_TYPE_PEHSTR_EXT,08 00 08 00 07 00 00 "
		
	strings :
		$a_81_0 = {64 65 63 72 79 70 74 20 73 75 63 63 65 73 73 66 75 6c 21 } //2 decrypt successful!
		$a_81_1 = {61 4c 64 62 63 47 67 63 64 40 68 64 66 3b 69 66 66 39 69 67 66 35 6a 67 67 2f 6b 68 67 29 6b 68 67 } //1 aLdbcGgcd@hdf;iff9igf5jgg/khg)khg
		$a_81_2 = {62 57 65 62 64 52 67 63 65 4e 68 64 66 48 6a 65 68 41 6a 66 68 3c 6c 68 69 39 6c 69 6a 36 6d 69 6a 2f 6e 6a 6b 28 6e 6a 6b } //1 bWebdRgceNhdfHjehAjfh<lhi9lij6mij/njk(njk
		$a_81_3 = {66 62 64 58 68 64 65 53 69 65 67 4f 6a 66 68 47 6c 68 69 41 6d 69 6a 3c 6d 69 6b 39 6f 6b 6c 35 6f 6b 6c 2e 70 6c 6d 27 71 6c 6c 21 72 6e 6e } //1 fbdXhdeSiegOjfhGlhiAmij<mik9okl5okl.plm'qll!rnn
		$a_81_4 = {61 6c 66 63 63 61 68 64 66 5a 6a 66 68 55 6b 67 6a 4f 6d 69 6a 48 6e 6b 6c 42 71 6d 6d 3e 71 6d 6e 3a 72 6e 6f 36 73 6f 6f 2e 73 6f 70 27 74 70 70 21 77 73 72 } //1 alfccahdfZjfhUkgjOmijHnklBqmm>qmn:rno6soo.sop'tpp!wsr
		$a_81_5 = {65 62 61 78 67 63 64 6e 6a 66 68 63 6b 67 69 5b 6c 68 6a 55 6d 69 6b 50 6f 6b 6d 49 70 6c 6e 42 71 6d 6f 3e 73 6e 70 3b 74 6f 71 37 74 70 71 } //1 ebaxgcdnjfhckgi[lhjUmikPokmIplnBqmo>snp;toq7tpq
		$a_81_6 = {6e 6a 6c 56 6f 6b 6d 51 72 6e 6f 48 73 6f 71 43 74 70 71 3f 75 71 72 3b 76 71 72 35 76 72 73 2d 77 72 73 26 78 74 75 21 } //1 njlVokmQrnoHsoqCtpq?uqr;vqr5vrs-wrs&xtu!
	condition:
		((#a_81_0  & 1)*2+(#a_81_1  & 1)*1+(#a_81_2  & 1)*1+(#a_81_3  & 1)*1+(#a_81_4  & 1)*1+(#a_81_5  & 1)*1+(#a_81_6  & 1)*1) >=8
 
}