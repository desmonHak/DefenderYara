
rule Trojan_Win64_NotDoor_A_dha{
	meta:
		description = "Trojan:Win64/NotDoor.A!dha,SIGNATURE_TYPE_PEHSTR_EXT,04 00 04 00 04 00 00 "
		
	strings :
		$a_01_0 = {43 72 65 61 74 65 50 72 6f 63 65 73 73 20 66 61 69 6c 65 64 20 28 } //1 CreateProcess failed (
		$a_01_1 = {2d 65 6e 63 20 4a 41 42 68 41 44 30 41 4a 41 42 6c 41 47 34 41 64 67 41 36 41 45 45 41 55 41 42 51 41 45 51 41 51 51 42 55 41 45 45 41 4f 77 42 6a 41 47 38 41 63 41 42 35 41 43 41 41 59 77 41 36 41 46 77 41 63 41 42 79 41 47 38 41 5a 77 42 79 41 47 45 41 62 51 42 6b 41 47 45 41 64 41 42 68 41 46 77 41 64 41 42 6c 41 48 4d 41 64 41 42 30 41 47 55 41 62 51 42 77 41 43 34 41 61 51 42 75 41 47 6b 41 49 41 41 69 41 43 51 41 59 51 42 63 41 45 30 41 61 51 42 6a 41 48 49 41 62 77 42 7a 41 47 38 41 5a 67 42 30 41 46 77 41 54 77 42 31 41 48 51 41 62 41 42 76 41 47 38 41 61 77 42 63 41 46 59 41 59 67 42 68 41 46 41 41 63 67 42 76 41 47 6f 41 5a 51 42 6a 41 48 51 41 4c 67 42 50 41 46 51 41 54 51 41 69 41 41 3d 3d } //1 -enc JABhAD0AJABlAG4AdgA6AEEAUABQAEQAQQBUAEEAOwBjAG8AcAB5ACAAYwA6AFwAcAByAG8AZwByAGEAbQBkAGEAdABhAFwAdABlAHMAdAB0AGUAbQBwAC4AaQBuAGkAIAAiACQAYQBcAE0AaQBjAHIAbwBzAG8AZgB0AFwATwB1AHQAbABvAG8AawBcAFYAYgBhAFAAcgBvAGoAZQBjAHQALgBPAFQATQAiAA==
		$a_01_2 = {2d 65 6e 63 20 62 67 42 7a 41 47 77 41 62 77 42 76 41 47 73 41 64 51 42 77 41 43 41 41 49 67 41 6b 41 47 55 41 62 67 42 32 41 44 6f 41 56 51 42 54 41 45 55 41 55 67 42 4f 41 45 45 41 54 51 42 46 41 43 34 41 4f 51 41 78 41 44 41 41 59 77 42 6d 41 44 4d 41 4e 51 41 78 41 43 30 41 59 51 41 77 41 44 55 41 5a 41 41 74 41 44 51 41 5a 67 41 32 41 44 63 41 4c 51 42 68 41 47 49 41 4f 41 42 6c 41 43 30 41 4e 67 42 6d 41 44 59 41 4d 67 42 6a 41 47 59 41 59 51 41 34 41 47 55 41 4d 67 41 32 41 47 51 41 4c 67 42 6b 41 47 34 41 63 77 42 6f 41 47 38 41 62 77 42 72 41 43 34 41 63 77 42 70 41 48 51 41 5a 51 41 69 41 41 3d 3d } //1 -enc bgBzAGwAbwBvAGsAdQBwACAAIgAkAGUAbgB2ADoAVQBTAEUAUgBOAEEATQBFAC4AOQAxADAAYwBmADMANQAxAC0AYQAwADUAZAAtADQAZgA2ADcALQBhAGIAOABlAC0ANgBmADYAMgBjAGYAYQA4AGUAMgA2AGQALgBkAG4AcwBoAG8AbwBrAC4AcwBpAHQAZQAiAA==
		$a_01_3 = {2d 65 6e 63 20 59 77 42 74 41 47 51 41 49 41 41 76 41 47 4d 41 49 41 42 6a 41 48 55 41 63 67 42 73 41 43 41 41 49 67 42 6f 41 48 51 41 64 41 42 77 41 44 6f 41 4c 77 41 76 41 48 63 41 5a 51 42 69 41 47 67 41 62 77 42 76 41 47 73 41 4c 67 42 7a 41 47 6b 41 64 41 42 6c 41 43 38 41 4f 51 41 78 41 44 41 41 59 77 42 6d 41 44 4d 41 4e 51 41 78 41 43 30 41 59 51 41 77 41 44 55 41 5a 41 41 74 41 44 51 41 5a 67 41 32 41 44 63 41 4c 51 42 68 41 47 49 41 4f 41 42 6c 41 43 30 41 4e 67 42 6d 41 44 59 41 4d 67 42 6a 41 47 59 41 59 51 41 34 41 47 55 41 4d 67 41 32 41 47 51 41 50 77 41 6b 41 47 55 41 62 67 42 32 41 44 6f 41 56 51 42 54 41 45 55 41 55 67 42 4f 41 45 45 41 54 51 42 46 41 43 49 41 } //1 -enc YwBtAGQAIAAvAGMAIABjAHUAcgBsACAAIgBoAHQAdABwADoALwAvAHcAZQBiAGgAbwBvAGsALgBzAGkAdABlAC8AOQAxADAAYwBmADMANQAxAC0AYQAwADUAZAAtADQAZgA2ADcALQBhAGIAOABlAC0ANgBmADYAMgBjAGYAYQA4AGUAMgA2AGQAPwAkAGUAbgB2ADoAVQBTAEUAUgBOAEEATQBFACIA
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1) >=4
 
}