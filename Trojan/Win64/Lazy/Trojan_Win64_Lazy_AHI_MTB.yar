
rule Trojan_Win64_Lazy_AHI_MTB{
	meta:
		description = "Trojan:Win64/Lazy.AHI!MTB,SIGNATURE_TYPE_PEHSTR_EXT,32 00 32 00 02 00 00 "
		
	strings :
		$a_03_0 = {44 89 cb 30 c3 44 08 c8 41 80 f1 ?? 80 f2 ?? 44 20 ca 08 ca 34 ?? 08 d8 89 c1 30 d1 a8 } //30
		$a_03_1 = {08 d0 89 ca 80 f2 ?? 20 c2 34 ?? 20 c8 08 d0 44 30 c8 89 c1 80 f1 ?? 41 20 c9 44 30 c9 } //20
	condition:
		((#a_03_0  & 1)*30+(#a_03_1  & 1)*20) >=50
 
}
rule Trojan_Win64_Lazy_AHI_MTB_2{
	meta:
		description = "Trojan:Win64/Lazy.AHI!MTB,SIGNATURE_TYPE_PEHSTR_EXT,0f 00 0f 00 02 00 00 "
		
	strings :
		$a_01_0 = {66 0f ef 85 d0 00 00 00 4c 89 bd e0 00 00 00 48 89 9d e8 00 00 00 66 0f ef 8d e0 00 00 00 66 0f 7f 8d 40 03 00 00 66 0f 7f 85 30 03 00 00 ff d0 } //10
		$a_03_1 = {49 33 c8 48 bf ?? ?? ?? ?? ?? ?? ?? ?? 48 8b c7 48 f7 e1 48 c1 ea ?? 48 8d 04 92 48 03 c0 48 2b c8 48 63 c1 48 8b cb 4c 89 84 c5 50 02 00 00 48 8b 84 c5 50 02 00 00 ff d0 } //5
	condition:
		((#a_01_0  & 1)*10+(#a_03_1  & 1)*5) >=15
 
}
rule Trojan_Win64_Lazy_AHI_MTB_3{
	meta:
		description = "Trojan:Win64/Lazy.AHI!MTB,SIGNATURE_TYPE_PEHSTR_EXT,0a 00 0a 00 03 00 00 "
		
	strings :
		$a_01_0 = {4c 89 74 24 50 48 89 44 24 40 48 c7 44 24 58 00 00 00 00 48 c7 44 24 48 01 00 00 00 c7 44 24 38 28 00 00 00 c7 44 24 30 96 00 00 00 c7 44 24 28 fa 00 00 00 c7 44 24 20 dc 00 00 00 } //5
		$a_01_1 = {4d 8d 48 1f 49 83 e1 e0 4d 8b d9 49 c1 eb 05 47 8b 9c 9a b0 5f 06 00 4d 03 da 41 } //3
		$a_80_2 = {43 68 65 61 74 69 6e 67 20 45 6e 67 69 6e 65 } //Cheating Engine  2
	condition:
		((#a_01_0  & 1)*5+(#a_01_1  & 1)*3+(#a_80_2  & 1)*2) >=10
 
}