
rule Trojan_Win64_Mikey_BAG_MTB{
	meta:
		description = "Trojan:Win64/Mikey.BAG!MTB,SIGNATURE_TYPE_PEHSTR_EXT,28 00 28 00 04 00 00 "
		
	strings :
		$a_01_0 = {20 20 20 20 20 20 20 20 38 09 00 00 00 20 46 00 00 06 00 00 00 dc 42 } //10
		$a_01_1 = {2e 72 73 72 63 00 00 00 58 f7 00 00 00 30 46 00 00 f8 00 00 00 e2 42 } //10
		$a_01_2 = {2e 69 64 61 74 61 00 00 00 10 00 00 00 30 47 00 00 02 00 00 00 da 43 } //10
		$a_01_3 = {2e 74 6c 73 00 00 00 00 00 30 00 00 00 40 47 00 00 26 00 00 00 dc 43 } //10
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*10+(#a_01_2  & 1)*10+(#a_01_3  & 1)*10) >=40
 
}
rule Trojan_Win64_Mikey_BAG_MTB_2{
	meta:
		description = "Trojan:Win64/Mikey.BAG!MTB,SIGNATURE_TYPE_PEHSTR_EXT,28 00 28 00 04 00 00 "
		
	strings :
		$a_01_0 = {40 2e 72 73 72 63 00 00 00 58 f7 00 00 00 30 46 00 00 f8 00 00 00 e2 42 } //10
		$a_01_1 = {2e 69 64 61 74 61 00 00 00 10 00 00 00 30 47 00 00 02 00 00 00 da 43 } //10
		$a_01_2 = {2e 74 68 65 6d 69 64 61 00 20 35 00 00 70 47 00 00 20 35 00 00 02 44 } //10
		$a_01_3 = {2e 72 65 6c 6f 63 00 00 00 10 00 00 00 90 7c 00 10 00 00 00 00 22 79 } //10
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*10+(#a_01_2  & 1)*10+(#a_01_3  & 1)*10) >=40
 
}
rule Trojan_Win64_Mikey_BAG_MTB_3{
	meta:
		description = "Trojan:Win64/Mikey.BAG!MTB,SIGNATURE_TYPE_PEHSTR_EXT,28 00 28 00 04 00 00 "
		
	strings :
		$a_01_0 = {2e 69 64 61 74 61 00 00 00 20 00 00 00 20 08 00 00 02 00 00 00 d6 07 } //10
		$a_03_1 = {2e 72 73 72 63 00 00 00 00 20 00 00 00 40 08 00 00 ?? 00 00 00 d8 07 } //10
		$a_03_2 = {2e 74 68 65 6d 69 64 61 00 c0 76 00 00 60 08 00 00 00 00 00 00 ?? 07 } //10
		$a_03_3 = {2e 62 6f 6f 74 00 00 00 00 ?? ?? 00 00 20 7f 00 00 ?? ?? 00 00 ?? 07 } //10
	condition:
		((#a_01_0  & 1)*10+(#a_03_1  & 1)*10+(#a_03_2  & 1)*10+(#a_03_3  & 1)*10) >=40
 
}