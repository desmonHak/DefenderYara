
rule Trojan_Win64_TofuStation_E_dha{
	meta:
		description = "Trojan:Win64/TofuStation.E!dha,SIGNATURE_TYPE_PEHSTR_EXT,04 00 04 00 26 00 00 "
		
	strings :
		$a_01_0 = {3f 41 56 69 75 73 62 33 37 71 40 } //1 ?AViusb37q@
		$a_01_1 = {3f 41 56 66 68 32 39 37 71 61 70 40 } //1 ?AVfh297qap@
		$a_01_2 = {3f 41 56 73 64 63 6e 6a 77 61 40 } //1 ?AVsdcnjwa@
		$a_01_3 = {3f 41 56 77 66 68 38 32 67 71 40 } //1 ?AVwfh82gq@
		$a_01_4 = {3f 41 56 6c 6b 65 39 38 37 32 65 40 } //1 ?AVlke9872e@
		$a_01_5 = {3f 41 56 6c 6b 62 76 75 6f 40 } //1 ?AVlkbvuo@
		$a_01_6 = {3f 41 56 62 73 64 66 37 32 6c 6f 40 } //1 ?AVbsdf72lo@
		$a_01_7 = {3f 41 56 75 6e 62 36 30 61 40 } //1 ?AVunb60a@
		$a_01_8 = {3f 41 56 69 75 6d 32 33 77 6e 67 40 } //1 ?AVium23wng@
		$a_01_9 = {3f 41 56 7a 63 38 32 33 34 61 40 } //1 ?AVzc8234a@
		$a_01_10 = {3f 41 56 6e 65 77 39 32 38 75 40 } //1 ?AVnew928u@
		$a_01_11 = {3f 41 56 62 6e 77 31 6f 65 6c 40 } //1 ?AVbnw1oel@
		$a_01_12 = {3f 41 56 71 6c 31 32 39 38 68 40 } //1 ?AVql1298h@
		$a_01_13 = {3f 41 56 61 64 6e 71 77 40 } //1 ?AVadnqw@
		$a_01_14 = {3f 41 56 6f 69 65 6e 34 39 6a 40 } //1 ?AVoien49j@
		$a_01_15 = {3f 41 56 6e 6f 32 33 34 72 65 40 } //1 ?AVno234re@
		$a_01_16 = {3f 41 56 62 6e 61 72 35 34 67 40 } //1 ?AVbnar54g@
		$a_01_17 = {3f 41 56 63 6e 71 77 70 6f 40 } //1 ?AVcnqwpo@
		$a_01_18 = {3f 41 56 6e 61 62 33 39 68 6b 40 } //1 ?AVnab39hk@
		$a_01_19 = {3f 41 56 6b 61 39 32 33 31 73 40 } //1 ?AVka9231s@
		$a_01_20 = {3f 41 56 71 70 33 34 73 64 40 } //1 ?AVqp34sd@
		$a_01_21 = {3f 41 56 61 73 64 66 61 77 67 77 65 72 40 } //1 ?AVasdfawgwer@
		$a_01_22 = {3f 41 56 68 61 73 6f 69 38 39 40 } //1 ?AVhasoi89@
		$a_01_23 = {3f 41 56 77 6f 69 72 6e 32 37 31 40 } //1 ?AVwoirn271@
		$a_01_24 = {3f 41 56 6e 61 63 65 38 32 31 40 } //1 ?AVnace821@
		$a_01_25 = {3f 41 56 62 73 61 64 75 66 32 40 } //1 ?AVbsaduf2@
		$a_01_26 = {3f 41 56 6e 64 6f 66 30 71 37 40 } //1 ?AVndof0q7@
		$a_01_27 = {3f 41 56 77 38 72 32 33 72 68 40 } //1 ?AVw8r23rh@
		$a_01_28 = {3f 41 56 78 63 76 62 30 75 39 68 40 } //1 ?AVxcvb0u9h@
		$a_01_29 = {3f 41 56 6a 32 31 38 33 61 40 } //1 ?AVj2183a@
		$a_01_30 = {3f 41 56 73 30 39 63 76 40 } //1 ?AVs09cv@
		$a_01_31 = {3f 41 56 69 6f 77 75 39 33 68 71 40 } //1 ?AViowu93hq@
		$a_01_32 = {3f 41 56 6d 73 64 31 68 33 40 } //1 ?AVmsd1h3@
		$a_01_33 = {3f 41 56 73 71 30 38 33 72 74 40 } //1 ?AVsq083rt@
		$a_01_34 = {3f 41 56 6e 61 72 38 39 33 37 36 40 } //1 ?AVnar89376@
		$a_01_35 = {3f 41 56 6f 69 64 66 65 64 40 } //1 ?AVoidfed@
		$a_00_36 = {3f 41 56 41 45 53 32 35 36 43 69 70 68 65 72 40 } //2 ?AVAES256Cipher@
		$a_00_37 = {3f 41 56 47 61 6d 6d 61 43 72 79 70 74 6f 53 74 72 61 74 65 67 79 40 } //2 ?AVGammaCryptoStrategy@
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1+(#a_01_8  & 1)*1+(#a_01_9  & 1)*1+(#a_01_10  & 1)*1+(#a_01_11  & 1)*1+(#a_01_12  & 1)*1+(#a_01_13  & 1)*1+(#a_01_14  & 1)*1+(#a_01_15  & 1)*1+(#a_01_16  & 1)*1+(#a_01_17  & 1)*1+(#a_01_18  & 1)*1+(#a_01_19  & 1)*1+(#a_01_20  & 1)*1+(#a_01_21  & 1)*1+(#a_01_22  & 1)*1+(#a_01_23  & 1)*1+(#a_01_24  & 1)*1+(#a_01_25  & 1)*1+(#a_01_26  & 1)*1+(#a_01_27  & 1)*1+(#a_01_28  & 1)*1+(#a_01_29  & 1)*1+(#a_01_30  & 1)*1+(#a_01_31  & 1)*1+(#a_01_32  & 1)*1+(#a_01_33  & 1)*1+(#a_01_34  & 1)*1+(#a_01_35  & 1)*1+(#a_00_36  & 1)*2+(#a_00_37  & 1)*2) >=4
 
}