
rule Trojan_Win64_ReverseShell_SXA_MTB{
	meta:
		description = "Trojan:Win64/ReverseShell.SXA!MTB,SIGNATURE_TYPE_PEHSTR_EXT,20 00 20 00 04 00 00 "
		
	strings :
		$a_03_0 = {48 01 d0 0f b6 00 83 f0 ?? 89 c1 8b 45 ?? 48 63 d0 48 8b 45 ?? 48 01 d0 89 ca 88 10 } //20
		$a_03_1 = {48 ba 4f 75 76 65 72 74 75 72 48 b9 65 20 64 65 20 6c 61 20 48 89 10 48 89 48 ?? 48 ba 70 61 67 65 20 77 65 62 48 b9 20 65 66 66 65 63 74 75 48 89 50 ?? 48 89 48 ?? 48 bf 63 74 75 c3 a9 65 2e 00 } //10
		$a_01_2 = {73 68 75 74 64 6f 77 6e 20 2f 73 20 2f 74 20 31 } //1 shutdown /s /t 1
		$a_01_3 = {54 72 6f 6a 61 6e } //1 Trojan
	condition:
		((#a_03_0  & 1)*20+(#a_03_1  & 1)*10+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1) >=32
 
}