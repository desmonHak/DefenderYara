
rule Trojan_Win32_Fragtor_LM_MTB{
	meta:
		description = "Trojan:Win32/Fragtor.LM!MTB,SIGNATURE_TYPE_PEHSTR_EXT,19 00 19 00 02 00 00 "
		
	strings :
		$a_03_0 = {8a 95 e7 ef ff ff 2a d0 8b 85 18 f0 ff ff 02 d1 30 17 83 c0 21 3b 85 14 f0 ff ff 7e ?? ff 8d 0c f0 ff ff 3b c6 7c ?? 8b d6 d1 ea 2b d6 03 d0 8d 7c 0a 05 eb } //15
		$a_03_1 = {83 fa 67 75 ?? 8d 4c 00 01 8b d0 d3 e2 8d 48 01 85 c9 7e ?? 8d 49 00 0f af d0 03 d2 03 d2 03 d2 49 75 f4 } //10
	condition:
		((#a_03_0  & 1)*15+(#a_03_1  & 1)*10) >=25
 
}
rule Trojan_Win32_Fragtor_LM_MTB_2{
	meta:
		description = "Trojan:Win32/Fragtor.LM!MTB,SIGNATURE_TYPE_PEHSTR_EXT,23 00 23 00 03 00 00 "
		
	strings :
		$a_03_0 = {c6 44 24 19 24 c6 44 24 1a 74 [0-07] c6 44 24 1b 72 c6 44 24 1c 69 [0-05] c6 44 24 1d 67 c6 44 24 1e 67 c6 44 24 1f 65 c6 44 24 20 72 } //20
		$a_03_1 = {0f b6 84 14 7c 01 00 00 88 04 17 83 c2 01 83 fa ?? ?? ?? 89 7c 24 04 89 34 24 c6 84 24 be 04 00 00 00 } //10
		$a_03_2 = {c6 44 24 26 53 c6 44 24 27 63 c6 44 24 28 68 c6 44 24 29 65 c6 44 24 2a 64 c6 44 24 2b 75 c6 44 24 2c 6c ?? ?? ?? ?? ?? ?? c6 44 24 2d 65 c6 44 24 2e 64 } //5
	condition:
		((#a_03_0  & 1)*20+(#a_03_1  & 1)*10+(#a_03_2  & 1)*5) >=35
 
}