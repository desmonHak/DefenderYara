
rule Trojan_Win32_DefendNot_X{
	meta:
		description = "Trojan:Win32/DefendNot.X,SIGNATURE_TYPE_PEHSTR_EXT,ffffffce 00 ffffffce 00 0c 00 00 "
		
	strings :
		$a_01_0 = {37 2c 10 f2 c3 90 0c 45 b3 f6 92 be 16 93 bd f2 } //100
		$a_01_1 = {56 97 4e 02 6c ba d1 4a 83 21 87 ba e7 8f d0 e3 } //100
		$a_01_2 = {ac af cb 4d ba 29 b1 46 80 fc b8 bd e3 c0 ae 4d } //1
		$a_01_3 = {65 a7 01 39 91 ab a9 4b a5 53 5b 85 38 de b8 40 } //1
		$a_01_4 = {a2 7c 00 cf e3 f5 e5 11 9c e9 5e 55 17 50 7c 66 } //1
		$a_03_5 = {54 01 04 80 90 0a 10 00 ff 15 } //1
		$a_80_6 = {41 56 20 4e 61 6d 65 20 63 61 6e 20 6e 6f 74 20 62 65 20 65 6d 70 74 79 21 } //AV Name can not be empty!  5
		$a_80_7 = {64 65 6c 61 79 69 6e 67 20 66 6f 72 20 63 6f 6d 20 72 65 74 72 79 } //delaying for com retry  5
		$a_80_8 = {7b 7d 5f 72 65 67 69 73 74 65 72 3a 20 7b 3a 23 78 7d } //{}_register: {:#x}  5
		$a_80_9 = {64 65 66 65 6e 64 6e 6f 74 3a 3a } //defendnot::  10
		$a_80_10 = {64 65 66 65 6e 64 65 72 2d 64 69 73 61 62 6c 65 72 2d 69 70 63 } //defender-disabler-ipc  10
		$a_01_11 = {63 74 78 2e 62 69 6e } //10 ctx.bin
	condition:
		((#a_01_0  & 1)*100+(#a_01_1  & 1)*100+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_03_5  & 1)*1+(#a_80_6  & 1)*5+(#a_80_7  & 1)*5+(#a_80_8  & 1)*5+(#a_80_9  & 1)*10+(#a_80_10  & 1)*10+(#a_01_11  & 1)*10) >=206
 
}