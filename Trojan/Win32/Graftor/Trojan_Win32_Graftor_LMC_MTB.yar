
rule Trojan_Win32_Graftor_LMC_MTB{
	meta:
		description = "Trojan:Win32/Graftor.LMC!MTB,SIGNATURE_TYPE_PEHSTR_EXT,1e 00 1e 00 02 00 00 "
		
	strings :
		$a_03_0 = {33 c0 85 c9 74 ?? ?? ?? 8d 9b 00 00 00 00 30 04 38 8b 8d e8 ec ff ff 40 3b c1 } //20
		$a_03_1 = {8a 47 01 47 84 c0 75 ?? ?? ?? ?? ?? ?? ?? 8d 85 f0 fe ff ff 89 17 48 8a 48 01 40 84 c9 75 ?? 66 8b 0d ?? ?? ?? ?? 8a 15 16 b2 40 00 8d bd f0 fe ff ff 66 89 08 88 50 02 4f 8d a4 24 00 00 00 00 } //10
	condition:
		((#a_03_0  & 1)*20+(#a_03_1  & 1)*10) >=30
 
}
rule Trojan_Win32_Graftor_LMC_MTB_2{
	meta:
		description = "Trojan:Win32/Graftor.LMC!MTB,SIGNATURE_TYPE_PEHSTR_EXT,1e 00 1e 00 02 00 00 "
		
	strings :
		$a_03_0 = {0f b6 95 3b ff ff ff 33 55 8c 89 55 dc 8b 85 dc fe ff ff 83 e8 45 83 c8 02 88 45 d7 0f b6 8d f3 fe ff ff 2b 8d 14 ff ff ff 81 f1 98 00 00 00 33 0d ?? ?? ?? ?? 88 8d f3 fe ff ff 0f b7 95 d0 fe ff ff 8b 45 b4 } //10
		$a_01_1 = {8b 4d e8 83 e9 4f 83 f1 15 66 89 8d c8 fe ff ff 8b 95 10 ff ff ff 2b 95 94 fe ff ff 83 e2 5b 89 95 50 ff ff ff 8b 85 a4 fe ff ff 83 c0 01 89 85 08 ff ff ff 8b 4d 8c 83 e1 21 8b 95 d8 fe ff ff 83 ea 18 33 ca 83 f1 35 } //20
	condition:
		((#a_03_0  & 1)*10+(#a_01_1  & 1)*20) >=30
 
}