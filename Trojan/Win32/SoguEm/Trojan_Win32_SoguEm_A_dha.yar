
rule Trojan_Win32_SoguEm_A_dha{
	meta:
		description = "Trojan:Win32/SoguEm.A!dha,SIGNATURE_TYPE_PEHSTR_EXT,0a 00 0a 00 0b 00 00 "
		
	strings :
		$a_42_0 = {ff 00 00 00 8b 74 24 90 01 01 89 0c 24 21 d1 21 d5 0f b6 04 08 01 c5 89 ef 21 d7 8b 54 24 90 01 01 8a 14 3a 88 14 0e 88 04 3e 8b 54 24 90 01 01 8a 0c 0e 00 c1 0f b6 c1 8b 4c 24 90 01 01 8a 0c 19 32 0c 06 8b 44 24 90 01 01 88 0c 1a 8b 1c 24 39 d8 90 00 09 } //10
		$a_31_1 = {89 c8 99 f7 ff 8a 04 13 30 44 0d 90 01 15 0f af c2 83 e0 01 90 00 01 00 2a 02 3f 43 6f 6d 70 61 72 65 46 69 6c 65 4d 6f 64 69 54 69 6d 65 90 01 01 43 58 55 73 62 40 40 43 41 4b 50 41 5f 57 30 40 5a } //6144
		$a_00_2 = {21 } //144 !
		$a_6e_3 = {6d 44 69 72 ?? 43 58 55 73 62 40 40 43 41 58 50 41 5f 57 5f 4e 4b 30 40 5a 90 00 01 00 24 02 3f 4c 6f 63 61 6c 43 6f 70 79 46 69 6c 65 ?? 43 58 55 73 62 40 40 43 41 4b 50 41 5f 57 30 40 5a } //16130
		$a_02_4 = {3f 55 73 62 43 6f 70 79 46 69 6c 65 50 72 6f 63 ?? 43 58 55 73 62 40 40 43 41 48 50 41 5f 57 30 40 5a } //1
		$a_02_5 = {3f 55 73 62 43 6f 70 79 46 69 6c 65 ?? 43 58 55 73 62 40 40 43 41 4b 50 41 5f 57 30 30 40 5a } //1
		$a_02_6 = {3f 45 6e 63 6f 64 65 4e 61 6d 65 ?? 43 58 55 73 62 40 40 43 41 4b 50 41 5f 57 30 40 5a } //1
		$a_02_7 = {3f 45 6e 63 6f 64 65 42 75 66 66 65 72 ?? 43 58 55 73 62 40 40 43 41 48 50 41 45 48 4b 40 5a } //1
		$a_02_8 = {3f 55 73 62 44 61 74 45 6e 63 6f 64 65 54 68 72 65 61 64 ?? 43 58 55 73 62 40 40 43 41 4b 50 41 5f 57 30 40 5a } //1
		$a_02_9 = {3f 52 65 61 64 44 65 73 6b 46 69 6c 65 ?? 43 58 55 73 62 40 40 43 41 4b 50 41 5f 57 40 5a } //1
		$a_04_10 = {00 00 d1 39 07 80 5c 25 00 00 d2 39 07 80 00 00 01 00 08 00 0f 00 ac 21 53 6f 67 75 53 65 63 2e 41 21 64 68 61 00 00 01 40 05 82 70 00 04 00 78 34 00 00 01 00 01 00 02 00 00 01 00 1c 02 30 31 32 33 34 35 36 37 38 39 41 42 43 90 01 01 45 46 88 13 00 00 60 ea 00 00 90 00 ff ff 07 } //0
	condition:
		((#a_42_0  & 1)*10+(#a_31_1  & 1)*6144+(#a_00_2  & 1)*144+(#a_6e_3  & 1)*16130+(#a_02_4  & 1)*1+(#a_02_5  & 1)*1+(#a_02_6  & 1)*1+(#a_02_7  & 1)*1+(#a_02_8  & 1)*1+(#a_02_9  & 1)*1+(#a_04_10  & 1)*0) >=10
 
}