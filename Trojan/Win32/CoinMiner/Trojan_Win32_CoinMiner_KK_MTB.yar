
rule Trojan_Win32_CoinMiner_KK_MTB{
	meta:
		description = "Trojan:Win32/CoinMiner.KK!MTB,SIGNATURE_TYPE_PEHSTR_EXT,32 00 32 00 05 00 00 "
		
	strings :
		$a_01_0 = {43 3a 5c 41 70 70 43 61 63 68 65 5c 78 38 36 5c 73 76 63 68 6f 73 74 2e 65 78 65 } //40 C:\AppCache\x86\svchost.exe
		$a_03_1 = {2f 43 20 43 3a 5c 41 70 70 43 61 63 68 65 5c 78 38 36 5c 73 76 63 68 6f 73 74 2e 65 78 65 20 2d 6f 20 73 74 72 61 74 75 6d 2b 74 63 70 3a 2f 2f [0-30] 20 2d 75 20 61 6e 6f 6e 77 6f 72 6b 65 72 2e 25 52 41 4e 44 4f 4d 25 20 2d 70 20 78 } //10
		$a_03_2 = {2f 43 20 43 3a 5c 41 70 70 43 61 63 68 65 5c 78 38 36 5c 73 76 63 68 6f 73 74 2e 65 78 65 20 2d 61 20 63 72 79 70 74 6f 6e 69 67 68 74 20 2d 6f 20 73 74 72 61 74 75 6d 2b 74 63 70 3a 2f 2f [0-30] 20 2d 75 20 34 32 4a 44 36 5a 4e 6b 4d 51 54 48 4d 44 74 53 4e 68 77 45 74 7a 63 41 70 55 74 6a 7a 4a 72 77 37 47 36 4a 55 68 75 71 38 48 6d 48 43 4c 51 5a 35 41 48 37 62 47 73 47 70 39 64 34 35 37 55 54 7a 5a 62 63 42 59 72 5a 78 79 54 51 71 46 59 33 74 67 4a 69 4a 6e 36 45 44 62 5a 65 57 51 39 20 2d 70 20 78 } //10
		$a_03_3 = {2d 61 20 6d 37 20 2d 6f 20 73 74 72 61 74 75 6d 2b 74 63 70 3a 2f 2f [0-30] 20 2d 75 20 43 4a 4a 6b 56 7a 6a 78 38 47 4e 74 58 34 7a 33 39 35 62 44 59 34 47 46 57 4c 36 45 68 64 66 38 6b 4a 2e 25 52 41 4e 44 4f 4d 25 20 2d 70 20 78 } //10
		$a_03_4 = {2d 61 20 6d 37 20 2d 6f 20 73 74 72 61 74 75 6d 2b 74 63 70 3a 2f 2f [0-30] 20 2d 75 20 43 4a 4a 6b 56 7a 6a 78 38 47 4e 74 58 34 7a 33 39 35 62 44 59 34 47 46 57 4c 36 45 68 64 66 38 6b 4a 2e 53 45 52 56 45 52 25 52 41 4e 44 4f 4d 25 20 2d 70 20 78 } //10
	condition:
		((#a_01_0  & 1)*40+(#a_03_1  & 1)*10+(#a_03_2  & 1)*10+(#a_03_3  & 1)*10+(#a_03_4  & 1)*10) >=50
 
}