
rule Trojan_Win32_Tedy_ARR_MTB{
	meta:
		description = "Trojan:Win32/Tedy.ARR!MTB,SIGNATURE_TYPE_PEHSTR_EXT,1e 00 1e 00 03 00 00 "
		
	strings :
		$a_01_0 = {8b 4d fc 46 8a 04 3a 32 04 0b 88 03 8b 5d ec } //15
		$a_03_1 = {8b 45 f4 8b 4d f8 89 1e 5b 89 46 ?? 8b c6 5f 89 4e } //10
		$a_81_2 = {51 00 51 00 50 00 43 00 52 00 74 00 2e 00 65 00 78 00 65 00 } //5 QQPCRt.exe
	condition:
		((#a_01_0  & 1)*15+(#a_03_1  & 1)*10+(#a_81_2  & 1)*5) >=30
 
}
rule Trojan_Win32_Tedy_ARR_MTB_2{
	meta:
		description = "Trojan:Win32/Tedy.ARR!MTB,SIGNATURE_TYPE_PEHSTR_EXT,28 00 28 00 05 00 00 "
		
	strings :
		$a_01_0 = {b0 b3 03 f5 04 00 00 70 f5 b2 03 cc b7 00 } //10
		$a_01_1 = {3c 2d 3e 02 00 80 75 01 00 2e 3e 02 00 0a } //5
		$a_01_2 = {b0 b3 03 00 06 00 00 00 38 3e 02 } //3
		$a_01_3 = {e6 f3 02 00 00 60 10 00 } //2
		$a_81_4 = {53 74 65 61 6c 65 72 2e 65 78 65 } //20 Stealer.exe
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*5+(#a_01_2  & 1)*3+(#a_01_3  & 1)*2+(#a_81_4  & 1)*20) >=40
 
}
rule Trojan_Win32_Tedy_ARR_MTB_3{
	meta:
		description = "Trojan:Win32/Tedy.ARR!MTB,SIGNATURE_TYPE_PEHSTR_EXT,1e 00 1e 00 03 00 00 "
		
	strings :
		$a_01_0 = {24 30 36 39 65 37 64 62 61 2d 33 62 36 38 2d 34 35 62 34 2d 61 38 37 33 2d 34 32 34 38 37 33 37 30 63 62 32 65 } //10 $069e7dba-3b68-45b4-a873-42487370cb2e
		$a_81_1 = {53 74 65 61 6c 31 2e 65 78 65 } //15 Steal1.exe
		$a_81_2 = {53 74 65 61 6c 2e 50 72 6f 70 65 72 74 69 65 73 2e 52 65 73 6f 75 72 63 65 73 } //5 Steal.Properties.Resources
	condition:
		((#a_01_0  & 1)*10+(#a_81_1  & 1)*15+(#a_81_2  & 1)*5) >=30
 
}
rule Trojan_Win32_Tedy_ARR_MTB_4{
	meta:
		description = "Trojan:Win32/Tedy.ARR!MTB,SIGNATURE_TYPE_PEHSTR_EXT,3c 00 3c 00 03 00 00 "
		
	strings :
		$a_03_0 = {f2 0f 10 44 24 30 b8 ?? ?? ?? ?? f2 0f 10 0d ?? ?? ?? ?? 66 0f 1f 44 ?? ?? f2 0f 59 c2 f2 0f 58 c1 83 e8 } //30
		$a_01_1 = {f2 0f 59 f0 f2 0f 59 f0 f2 0f 59 f0 83 e8 03 75 ef } //20
		$a_01_2 = {66 0f 6f c1 66 0f fc c1 66 0f fc c1 66 0f 6f c8 66 0f fc c8 66 0f fc c9 66 0f fc c9 66 0f fc c1 } //10
	condition:
		((#a_03_0  & 1)*30+(#a_01_1  & 1)*20+(#a_01_2  & 1)*10) >=60
 
}