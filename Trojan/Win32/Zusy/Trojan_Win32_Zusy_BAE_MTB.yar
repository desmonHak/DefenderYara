
rule Trojan_Win32_Zusy_BAE_MTB{
	meta:
		description = "Trojan:Win32/Zusy.BAE!MTB,SIGNATURE_TYPE_PEHSTR_EXT,02 00 02 00 01 00 00 "
		
	strings :
		$a_03_0 = {8b 4d 8c 8a 44 15 98 30 04 0f 47 81 ff ?? ?? ?? ?? 7c } //2
	condition:
		((#a_03_0  & 1)*2) >=2
 
}
rule Trojan_Win32_Zusy_BAE_MTB_2{
	meta:
		description = "Trojan:Win32/Zusy.BAE!MTB,SIGNATURE_TYPE_PEHSTR_EXT,20 00 20 00 05 00 00 "
		
	strings :
		$a_01_0 = {c0 0c 00 00 10 00 00 00 f0 04 00 00 10 00 00 00 00 00 00 00 00 00 00 00 00 00 00 40 00 00 e0 } //10
		$a_01_1 = {10 00 00 00 d0 0c 00 00 00 00 00 00 00 05 00 00 00 00 00 00 00 00 00 00 00 00 00 40 00 00 c0 } //10
		$a_01_2 = {10 00 00 00 e0 0c 00 00 02 00 00 00 00 05 00 00 00 00 00 00 00 00 00 00 00 00 00 40 00 00 c0 } //10
		$a_81_3 = {25 75 73 65 72 61 70 70 64 61 74 61 25 5c 52 65 73 74 61 72 74 41 70 70 2e 65 78 65 } //1 %userappdata%\RestartApp.exe
		$a_81_4 = {54 68 65 6d 69 64 61 } //1 Themida
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*10+(#a_01_2  & 1)*10+(#a_81_3  & 1)*1+(#a_81_4  & 1)*1) >=32
 
}
rule Trojan_Win32_Zusy_BAE_MTB_3{
	meta:
		description = "Trojan:Win32/Zusy.BAE!MTB,SIGNATURE_TYPE_PEHSTR_EXT,21 00 21 00 06 00 00 "
		
	strings :
		$a_01_0 = {aa c8 0f 00 00 10 00 00 00 40 07 00 00 10 00 00 00 00 00 00 00 00 00 00 00 00 00 00 20 00 00 60 } //10
		$a_01_1 = {c0 9f 95 00 00 e0 0f 00 00 20 4b 00 00 50 07 00 00 00 00 00 00 00 00 00 00 00 00 00 40 00 00 40 } //10
		$a_01_2 = {aa 1b 07 00 00 80 a5 00 00 a0 00 00 00 70 52 00 00 00 00 00 00 00 00 00 00 00 00 00 40 00 00 c0 } //10
		$a_81_3 = {73 68 6f 77 63 6f 64 65 } //1 showcode
		$a_81_4 = {63 68 65 63 6b 70 72 6f 74 65 63 74 69 6f 6e } //1 checkprotection
		$a_81_5 = {53 4f 46 54 57 41 52 45 5c 57 69 6e 4c 69 63 65 6e 73 65 } //1 SOFTWARE\WinLicense
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*10+(#a_01_2  & 1)*10+(#a_81_3  & 1)*1+(#a_81_4  & 1)*1+(#a_81_5  & 1)*1) >=33
 
}