
rule Trojan_Win32_Convagent_ARR_MTB{
	meta:
		description = "Trojan:Win32/Convagent.ARR!MTB,SIGNATURE_TYPE_PEHSTR_EXT,0a 00 0a 00 02 00 00 "
		
	strings :
		$a_01_0 = {f7 f9 52 8d 54 3c 14 68 } //2
		$a_01_1 = {8b c1 33 d2 f7 f3 8a 04 2a 8a 14 31 32 d0 88 14 31 41 3b cf } //8
	condition:
		((#a_01_0  & 1)*2+(#a_01_1  & 1)*8) >=10
 
}
rule Trojan_Win32_Convagent_ARR_MTB_2{
	meta:
		description = "Trojan:Win32/Convagent.ARR!MTB,SIGNATURE_TYPE_PEHSTR_EXT,14 00 14 00 02 00 00 "
		
	strings :
		$a_01_0 = {83 f0 01 48 8b 4c 24 18 48 8b 5c 24 20 89 c2 48 8b 44 24 68 } //15
		$a_03_1 = {48 8b 72 18 48 83 c6 fe 48 83 fe 0b 0f 87 ?? ?? ?? ?? 4c 8b 42 ?? 48 8d 05 } //5
	condition:
		((#a_01_0  & 1)*15+(#a_03_1  & 1)*5) >=20
 
}
rule Trojan_Win32_Convagent_ARR_MTB_3{
	meta:
		description = "Trojan:Win32/Convagent.ARR!MTB,SIGNATURE_TYPE_PEHSTR_EXT,1e 00 1e 00 03 00 00 "
		
	strings :
		$a_03_0 = {8b c1 8a 9c 0d ?? ?? ?? ?? 99 f7 ff 8b 45 08 0f b6 04 02 } //15
		$a_01_1 = {47 65 6e 65 72 69 63 4c 6f 67 49 6d 70 6c } //10 GenericLogImpl
		$a_01_2 = {5b 4f 72 61 6e 67 65 36 34 5d 20 44 65 6c 65 74 65 46 69 6c 65 50 61 74 68 3a 25 77 5a } //5 [Orange64] DeleteFilePath:%wZ
	condition:
		((#a_03_0  & 1)*15+(#a_01_1  & 1)*10+(#a_01_2  & 1)*5) >=30
 
}
rule Trojan_Win32_Convagent_ARR_MTB_4{
	meta:
		description = "Trojan:Win32/Convagent.ARR!MTB,SIGNATURE_TYPE_PEHSTR_EXT,14 00 14 00 04 00 00 "
		
	strings :
		$a_01_0 = {7a 30 4c 6a 51 75 53 44 51 73 69 44 51 76 64 43 77 30 59 6a 51 74 64 43 35 49 4e 47 42 30 } //15 z0LjQuSDQsiDQvdCw0YjQtdC5INGB0
		$a_01_1 = {24 63 6f 64 65 42 36 34 20 3d 20 22 4a 46 4e 6c 63 33 4e 70 62 32 35 4a 5a 43 41 39 49 43 49 6e 49 69 49 } //15 $codeB64 = "JFNlc3Npb25JZCA9ICInIiI
		$a_01_2 = {4c 53 44 51 76 39 43 2b 30 4c 54 51 74 64 47 41 49 4e 43 66 30 4c 37 51 75 39 47 4d 30 4c 66 51 76 74 43 79 4c 69 49 4b 22 29 } //15 LSDQv9C+0LTQtdGAINCf0L7Qu9GM0LfQvtCyLiIK")
		$a_01_3 = {62 00 6f 00 62 00 72 00 69 00 6b 00 2e 00 65 00 78 00 65 00 } //5 bobrik.exe
	condition:
		((#a_01_0  & 1)*15+(#a_01_1  & 1)*15+(#a_01_2  & 1)*15+(#a_01_3  & 1)*5) >=20
 
}