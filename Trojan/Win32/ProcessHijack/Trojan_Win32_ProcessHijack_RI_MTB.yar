
rule Trojan_Win32_ProcessHijack_RI_MTB{
	meta:
		description = "Trojan:Win32/ProcessHijack.RI!MTB,SIGNATURE_TYPE_PEHSTR_EXT,08 00 08 00 04 00 00 "
		
	strings :
		$a_03_0 = {8b 45 f0 8b 40 04 89 45 e4 8b 45 f0 8b 00 89 45 e0 8b 45 ec 89 45 d8 8b 45 f0 83 c0 08 89 45 d4 8b 45 e8 89 45 d0 ff 15 ?? ?? ?? ?? 8b 55 d0 8b 4d d4 89 c3 8b 45 d8 8d 7d e0 8d 75 e4 89 1c 24 89 7c 24 04 89 74 24 08 89 54 24 0c 89 4c 24 10 ff } //3
		$a_03_1 = {8b 45 f8 3b 45 0c 73 ?? 0f be 75 10 8b 45 08 8b 4d f8 0f be 14 08 31 f2 88 14 08 8b 45 f8 83 c0 01 89 45 f8 eb } //2
		$a_03_2 = {8b 55 08 8b 45 e4 03 50 0c 8b 4d 0c 8b 45 e4 03 48 0c 8b 45 e4 8b 40 08 89 14 24 89 4c 24 04 89 44 24 08 e8 ?? ?? ?? ?? 8b 4d f4 8b 45 e4 8b 50 08 8b 75 08 8b 45 e4 03 70 0c 8d 45 f4 89 34 24 89 54 24 04 89 4c 24 08 89 44 24 0c ff 15 } //2
		$a_01_3 = {6f 62 66 75 73 63 61 74 65 64 5f 73 68 65 6c 6c 63 6f 64 65 72 75 6e 6e 65 72 2e 65 78 65 } //1 obfuscated_shellcoderunner.exe
	condition:
		((#a_03_0  & 1)*3+(#a_03_1  & 1)*2+(#a_03_2  & 1)*2+(#a_01_3  & 1)*1) >=8
 
}