
rule MonitoringTool_AndroidOS_PhoneSpy_I_MTB{
	meta:
		description = "MonitoringTool:AndroidOS/PhoneSpy.I!MTB,SIGNATURE_TYPE_DEXHSTR_EXT,02 00 02 00 02 00 00 "
		
	strings :
		$a_01_0 = {52 83 d7 02 6e 20 f1 04 36 00 0a 03 38 03 08 00 52 63 37 01 b1 a3 01 24 01 45 28 06 52 63 37 01 01 34 01 93 01 a5 52 8b d7 02 13 10 00 00 33 ab 1e 00 54 6b 39 01 6e 10 63 08 0b 00 0a 0b 14 0c ff ff ff 7f 32 43 2c 00 } //1
		$a_01_1 = {52 62 3c 01 52 63 eb 00 52 04 56 00 12 05 71 55 60 04 32 45 0a 02 6e 55 ed 04 f6 21 52 81 d7 02 33 a1 0e 00 6e 20 b5 04 e9 00 0a 01 54 62 39 01 6e 20 5b 08 f2 00 0a 02 b0 12 28 0d 6e 20 b8 04 e9 00 0a 02 54 61 39 01 6e 20 5b 08 f1 00 0a 01 91 01 02 01 52 83 d7 02 54 00 10 01 33 a3 06 00 6e 20 af 04 f0 00 28 04 } //1
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1) >=2
 
}
rule MonitoringTool_AndroidOS_PhoneSpy_I_MTB_2{
	meta:
		description = "MonitoringTool:AndroidOS/PhoneSpy.I!MTB,SIGNATURE_TYPE_DEXHSTR_EXT,05 00 05 00 05 00 00 "
		
	strings :
		$a_01_0 = {4c 63 6f 6d 2f 73 70 61 74 72 61 6b 61 70 70 70 2f 61 6c 61 72 6d 2f 61 63 74 69 76 69 74 69 65 73 2f 50 68 6f 6e 65 41 6c 72 65 61 64 79 52 65 67 69 73 74 65 72 65 64 } //1 Lcom/spatrakappp/alarm/activities/PhoneAlreadyRegistered
		$a_01_1 = {4c 63 6f 6d 2f 73 70 61 74 72 61 6b 61 70 70 70 2f 61 6c 61 72 6d 2f 61 63 74 69 76 69 74 69 65 73 2f 45 6e 61 62 6c 65 4e 6f 74 69 66 69 63 61 74 69 6f 6e 41 63 63 65 73 73 } //1 Lcom/spatrakappp/alarm/activities/EnableNotificationAccess
		$a_01_2 = {4c 63 6f 6d 2f 73 70 61 74 72 61 6b 61 70 70 70 2f 61 6c 61 72 6d 2f 73 65 72 76 69 63 65 73 2f 52 65 6d 6f 74 65 52 65 63 6f 72 64 69 6e 67 53 65 72 76 69 63 65 } //1 Lcom/spatrakappp/alarm/services/RemoteRecordingService
		$a_01_3 = {4c 63 6f 6d 2f 73 70 61 74 72 61 6b 61 70 70 70 2f 61 6c 61 72 6d 2f 73 65 72 76 69 63 65 73 2f 54 72 61 63 6b 4c 6f 63 61 74 69 6f 6e } //1 Lcom/spatrakappp/alarm/services/TrackLocation
		$a_01_4 = {4c 63 6f 6d 2f 73 70 61 74 72 61 6b 61 70 70 70 2f 61 6c 61 72 6d 2f 53 65 72 76 65 72 43 6f 6d 6d 75 6e 69 63 61 74 65 } //1 Lcom/spatrakappp/alarm/ServerCommunicate
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1) >=5
 
}