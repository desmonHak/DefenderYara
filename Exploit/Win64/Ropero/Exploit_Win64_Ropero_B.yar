
rule Exploit_Win64_Ropero_B{
	meta:
		description = "Exploit:Win64/Ropero.B,SIGNATURE_TYPE_PEHSTR_EXT,1b 00 19 00 08 00 00 "
		
	strings :
		$a_01_0 = {48 83 ec 28 33 c0 38 05 } //1
		$a_01_1 = {48 81 c4 40 02 00 00 41 5f 41 5e 41 5d 41 5c 5f 5e 5d c3 } //1
		$a_01_2 = {48 c7 c1 02 00 00 80 } //5
		$a_01_3 = {48 41 52 44 57 41 52 45 5c 44 45 53 43 52 49 50 54 49 4f 4e 5c 53 79 73 74 65 6d } //5 HARDWARE\DESCRIPTION\System
		$a_01_4 = {49 64 65 6e 74 69 66 69 65 72 } //5 Identifier
		$a_01_5 = {47 65 74 44 65 76 69 63 65 44 72 69 76 65 72 42 61 73 65 4e 61 6d 65 41 } //5 GetDeviceDriverBaseNameA
		$a_01_6 = {52 4f 50 20 63 68 61 69 6e } //5 ROP chain
		$a_01_7 = {67 5f 43 69 45 6e 61 62 6c 65 64 } //5 g_CiEnabled
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*5+(#a_01_3  & 1)*5+(#a_01_4  & 1)*5+(#a_01_5  & 1)*5+(#a_01_6  & 1)*5+(#a_01_7  & 1)*5) >=25
 
}