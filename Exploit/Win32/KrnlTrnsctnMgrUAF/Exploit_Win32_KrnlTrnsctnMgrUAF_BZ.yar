
rule Exploit_Win32_KrnlTrnsctnMgrUAF_BZ{
	meta:
		description = "Exploit:Win32/KrnlTrnsctnMgrUAF.BZ,SIGNATURE_TYPE_PEHSTR_EXT,37 00 37 00 07 00 00 "
		
	strings :
		$a_00_0 = {4e 74 43 72 65 61 74 65 54 72 61 6e 73 61 63 74 69 6f 6e 4d 61 6e 61 67 65 72 } //10 NtCreateTransactionManager
		$a_00_1 = {4e 74 43 72 65 61 74 65 52 65 73 6f 75 72 63 65 4d 61 6e 61 67 65 72 } //10 NtCreateResourceManager
		$a_01_2 = {ba 7f 00 1f 00 } //10
		$a_01_3 = {0f ff ff 39 89 } //15
		$a_03_4 = {0f ff ff 39 c7 [0-04] 00 00 00 00 } //15
		$a_01_5 = {ba 3f 00 1f 00 89 } //10
		$a_01_6 = {ba 3f 00 1f 00 48 } //10
	condition:
		((#a_00_0  & 1)*10+(#a_00_1  & 1)*10+(#a_01_2  & 1)*10+(#a_01_3  & 1)*15+(#a_03_4  & 1)*15+(#a_01_5  & 1)*10+(#a_01_6  & 1)*10) >=55
 
}