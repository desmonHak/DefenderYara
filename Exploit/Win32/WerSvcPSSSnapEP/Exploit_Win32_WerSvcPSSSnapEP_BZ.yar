
rule Exploit_Win32_WerSvcPSSSnapEP_BZ{
	meta:
		description = "Exploit:Win32/WerSvcPSSSnapEP.BZ,SIGNATURE_TYPE_PEHSTR_EXT,37 00 37 00 06 00 00 "
		
	strings :
		$a_00_0 = {77 65 72 66 61 75 6c 74 2e 65 78 65 } //10 werfault.exe
		$a_00_1 = {5c 00 57 00 69 00 6e 00 64 00 6f 00 77 00 73 00 45 00 72 00 72 00 6f 00 72 00 52 00 65 00 70 00 6f 00 72 00 74 00 69 00 6e 00 67 00 53 00 65 00 72 00 76 00 69 00 63 00 65 00 50 00 6f 00 72 00 74 00 } //10 \WindowsErrorReportingServicePort
		$a_00_2 = {4e 74 41 6c 70 63 53 65 6e 64 57 61 69 74 52 65 63 65 69 76 65 50 6f 72 74 } //10 NtAlpcSendWaitReceivePort
		$a_00_3 = {4e 74 51 75 65 75 65 41 70 63 54 68 72 65 61 64 45 78 } //10 NtQueueApcThreadEx
		$a_03_4 = {d8 ea 6e e4 [0-07] 54 0c 89 44 } //15
		$a_03_5 = {d8 ea 6e e4 [0-02] 54 0c 00 00 [0-06] 89 44 } //15
	condition:
		((#a_00_0  & 1)*10+(#a_00_1  & 1)*10+(#a_00_2  & 1)*10+(#a_00_3  & 1)*10+(#a_03_4  & 1)*15+(#a_03_5  & 1)*15) >=55
 
}