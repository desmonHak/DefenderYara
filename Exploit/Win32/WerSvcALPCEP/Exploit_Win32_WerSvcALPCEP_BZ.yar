
rule Exploit_Win32_WerSvcALPCEP_BZ{
	meta:
		description = "Exploit:Win32/WerSvcALPCEP.BZ,SIGNATURE_TYPE_PEHSTR_EXT,4b 00 4b 00 09 00 00 "
		
	strings :
		$a_00_0 = {77 65 72 66 61 75 6c 74 2e 65 78 65 } //10 werfault.exe
		$a_00_1 = {5c 00 57 00 69 00 6e 00 64 00 6f 00 77 00 73 00 45 00 72 00 72 00 6f 00 72 00 52 00 65 00 70 00 6f 00 72 00 74 00 69 00 6e 00 67 00 53 00 65 00 72 00 76 00 69 00 63 00 65 00 50 00 6f 00 72 00 74 00 } //10 \WindowsErrorReportingServicePort
		$a_00_2 = {4e 74 41 6c 70 63 43 6f 6e 6e 65 63 74 50 6f 72 74 } //10 NtAlpcConnectPort
		$a_00_3 = {4e 74 53 75 73 70 65 6e 64 50 72 6f 63 65 73 73 } //10 NtSuspendProcess
		$a_03_4 = {d8 ea 6e e4 [0-08] 54 0c 89 44 } //15
		$a_03_5 = {d8 ea 6e e4 [0-03] 54 0c 00 00 [0-07] 89 44 00 00 } //15
		$a_03_6 = {33 d2 b9 00 00 10 00 [0-05] ff 15 } //10
		$a_01_7 = {c7 87 0c 01 00 00 22 00 00 c0 } //10
		$a_01_8 = {c7 80 0c 01 00 00 22 00 00 c0 } //10
	condition:
		((#a_00_0  & 1)*10+(#a_00_1  & 1)*10+(#a_00_2  & 1)*10+(#a_00_3  & 1)*10+(#a_03_4  & 1)*15+(#a_03_5  & 1)*15+(#a_03_6  & 1)*10+(#a_01_7  & 1)*10+(#a_01_8  & 1)*10) >=75
 
}