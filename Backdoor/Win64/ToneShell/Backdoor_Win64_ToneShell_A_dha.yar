
rule Backdoor_Win64_ToneShell_A_dha{
	meta:
		description = "Backdoor:Win64/ToneShell.A!dha,SIGNATURE_TYPE_PEHSTR_EXT,0b 00 0b 00 09 00 00 "
		
	strings :
		$a_01_0 = {69 c0 31 cb 44 4e 8d 52 01 0f be c9 03 c1 8a 0a 84 c9 } //10
		$a_01_1 = {69 c0 31 5e c8 00 8d 52 01 0f be c9 03 c1 8a 0a 84 c9 } //10
		$a_01_2 = {69 ff 31 5e c8 00 0f be c0 03 f8 43 8a 03 84 c0 } //10
		$a_01_3 = {8d 43 20 8d 53 bf 0f b6 c8 0f b6 c3 8d 7f 02 80 fa 19 0f 47 c8 0f b7 07 69 f6 31 5e c8 00 8a d8 0f be c9 03 f1 66 85 c0 } //1
		$a_01_4 = {8d 48 20 8d 58 bf 0f b6 d1 0f b6 c8 8d 76 02 80 fb 19 0f 47 d1 0f b7 0e 69 ff 31 5e c8 00 8a c1 0f be d2 03 fa 66 85 c9 } //1
		$a_01_5 = {8d 43 20 8d 53 bf 0f b6 c8 80 fa 19 0f b6 c3 8d 76 02 0f 47 c8 69 ff 31 5e c8 00 0f be c9 03 f9 0f b7 0e 8a d9 66 85 c9 } //1
		$a_01_6 = {8d 50 bf 8d 48 20 80 fa 19 0f b6 c9 8d 7f 02 0f b6 c0 0f 47 c8 69 db 31 cb 44 4e 0f be c9 03 d9 0f b7 0f 8a c1 66 85 c9 } //1
		$a_01_7 = {8d 50 bf 8d 48 20 80 fa 19 0f b6 c9 8d 76 02 0f b6 c0 0f 47 c8 69 c3 31 5e c8 00 0f be c9 8d 1c 08 0f b7 0e 8a c1 66 85 c9 } //1
		$a_01_8 = {8a 1f 8d 7f 02 8d 43 20 8d 53 bf 0f b6 c8 80 fa 19 0f b6 c3 0f 47 c8 69 45 fc 31 5e c8 00 0f be c9 03 c8 89 4d fc 66 39 37 } //1
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*10+(#a_01_2  & 1)*10+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1+(#a_01_8  & 1)*1) >=11
 
}