
rule Backdoor_Win64_Uallehs_A{
	meta:
		description = "Backdoor:Win64/Uallehs.A,SIGNATURE_TYPE_PEHSTR_EXT,05 00 05 00 08 00 00 "
		
	strings :
		$a_01_0 = {30 78 64 36 38 39 31 30 45 44 34 44 34 41 35 41 39 62 41 64 46 39 65 63 39 35 36 30 34 43 41 45 30 66 33 33 37 38 34 37 39 42 } //2 0xd68910ED4D4A5A9bAdF9ec95604CAE0f3378479B
		$a_01_1 = {61 30 2c 38 30 2c 38 30 2c 61 32 2c 61 30 2c 38 33 2c 38 64 2c 39 36 2c 36 35 2c 38 32 2c } //2 a0,80,80,a2,a0,83,8d,96,65,82,
		$a_03_2 = {22 6a 73 6f 6e 72 70 63 22 3a 20 22 32 2e 30 22 2c [0-20] 22 6d 65 74 68 6f 64 22 3a 20 22 65 74 68 5f 63 61 6c 6c 22 2c } //2
		$a_01_3 = {76 6f 69 64 2a 20 28 5f 5f 73 74 64 63 61 6c 6c 2a 29 28 76 6f 69 64 2a 2c 20 73 69 7a 65 5f 74 2c 20 4c 50 54 48 52 45 41 44 5f 53 54 41 52 54 5f 52 4f 55 54 49 4e 45 2c 20 76 6f 69 64 2a 2c 20 75 6c 6f 6e 67 2c 20 75 6c 6f 6e 67 2a 29 } //1 void* (__stdcall*)(void*, size_t, LPTHREAD_START_ROUTINE, void*, ulong, ulong*)
		$a_01_4 = {76 6f 69 64 2a 20 28 5f 5f 73 74 64 63 61 6c 6c 2a 29 28 76 6f 69 64 2a 2c 20 70 63 77 73 74 72 2c 20 70 63 77 73 74 72 2c 20 70 63 77 73 74 72 2c 20 70 63 77 73 74 72 2c 20 70 63 77 73 74 72 2a 2c 20 75 6c 6f 6e 67 2c 20 75 6c 6f 6e 67 29 } //1 void* (__stdcall*)(void*, pcwstr, pcwstr, pcwstr, pcwstr, pcwstr*, ulong, ulong)
		$a_03_5 = {74 79 70 65 64 65 66 20 69 6e 74 20 28 5f 5f 73 74 64 63 61 6c 6c 2a 20 46 41 52 50 52 4f 43 29 28 29 3b [0-30] 74 79 70 65 64 65 66 20 75 6e 73 69 67 6e 65 64 20 6c 6f 6e 67 20 28 5f 5f 73 74 64 63 61 6c 6c 2a 20 4c 50 54 48 52 45 41 44 5f 53 54 41 52 54 5f 52 4f 55 54 49 4e 45 29 28 76 6f 69 64 2a 29 3b } //1
		$a_01_6 = {73 63 68 74 61 73 6b 73 20 2f 63 72 65 61 74 65 20 2f 73 63 20 64 61 69 6c 79 20 2f 73 74 20 25 30 32 64 3a 25 30 32 64 20 2f 66 } //1 schtasks /create /sc daily /st %02d:%02d /f
		$a_01_7 = {58 3a 5c 6c 75 61 70 6f 77 65 72 5c 63 73 72 63 5c 6c 75 61 6a 69 74 5c 73 72 63 5c 73 72 63 } //1 X:\luapower\csrc\luajit\src\src
	condition:
		((#a_01_0  & 1)*2+(#a_01_1  & 1)*2+(#a_03_2  & 1)*2+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_03_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1) >=5
 
}