
rule Ransom_Win64_StopCrypt_GVA_MTB{
	meta:
		description = "Ransom:Win64/StopCrypt.GVA!MTB,SIGNATURE_TYPE_PEHSTR_EXT,07 00 07 00 06 00 00 "
		
	strings :
		$a_01_0 = {48 8b 54 24 28 48 89 d1 48 f7 ea 48 01 ca 48 c1 fa 05 48 6b d2 3e 48 89 ce 48 29 d1 88 4c 34 18 e9 68 ff ff ff } //1
		$a_01_1 = {6d 61 69 6e 2e 64 65 6c 65 74 65 53 68 61 64 6f 77 43 6f 70 79 } //2 main.deleteShadowCopy
		$a_01_2 = {6d 61 69 6e 2e 64 65 6c 65 74 65 44 69 72 73 } //1 main.deleteDirs
		$a_01_3 = {6d 61 69 6e 2e 67 65 6e 65 72 61 74 65 52 61 6e 64 6f 6d 4e 61 6d 65 } //1 main.generateRandomName
		$a_01_4 = {6d 61 69 6e 2e 6f 76 65 72 77 72 69 74 65 46 69 6c 65 6e 61 6d 65 } //1 main.overwriteFilename
		$a_01_5 = {6f 73 2e 72 65 6e 61 6d 65 } //1 os.rename
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*2+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1) >=7
 
}