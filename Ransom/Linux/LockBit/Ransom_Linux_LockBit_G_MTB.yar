
rule Ransom_Linux_LockBit_G_MTB{
	meta:
		description = "Ransom:Linux/LockBit.G!MTB,SIGNATURE_TYPE_ELFHSTR_EXT,05 00 05 00 05 00 00 "
		
	strings :
		$a_01_0 = {73 68 6f 75 6c 64 5f 62 79 70 61 73 73 5f 64 69 72 } //1 should_bypass_dir
		$a_01_1 = {73 68 6f 75 6c 64 5f 62 79 70 61 73 73 5f 66 69 6c 65 } //1 should_bypass_file
		$a_01_2 = {63 6c 65 61 72 5f 62 79 70 61 73 73 5f 63 61 63 68 65 73 } //1 clear_bypass_caches
		$a_01_3 = {44 0f b6 66 0d 48 83 c6 10 41 c1 e5 10 41 c1 e7 18 41 c1 e4 08 45 09 ec 44 8b 6c 24 ec 45 09 f4 4d 89 c6 45 09 fc 4c 8b 7c 24 f0 4c 01 e1 49 89 fc 4c 0f af e3 4d 0f af f1 4d 01 e6 49 89 d4 44 0f af e8 4c 0f af f9 4c 0f af e5 4d 01 ee 4d 89 c5 4d 01 fe 49 89 ff } //1
		$a_01_4 = {4c 33 57 20 48 01 c5 49 31 d8 48 03 5f 68 49 31 e9 49 c1 c0 20 49 c1 c1 30 48 33 6f 10 4d 01 c4 4d 01 cf 4c 33 4f 28 4c 31 e6 48 33 6c 24 d8 4c 31 f8 48 c1 c6 28 4c 33 3f 48 01 f3 4c 33 7c 24 d0 49 31 d8 48 33 5f 18 4c 31 c9 } //1
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1) >=5
 
}