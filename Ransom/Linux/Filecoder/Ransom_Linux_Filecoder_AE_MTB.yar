
rule Ransom_Linux_Filecoder_AE_MTB{
	meta:
		description = "Ransom:Linux/Filecoder.AE!MTB,SIGNATURE_TYPE_ELFHSTR_EXT,03 00 03 00 03 00 00 "
		
	strings :
		$a_01_0 = {be 47 bb 40 00 31 c0 bf d8 b9 40 00 e8 44 1d 00 00 0f b6 3d fd f6 20 00 e8 88 42 00 00 bf 18 00 00 00 48 89 05 3c f7 20 00 e8 57 fa ff ff 4c 89 ef 48 89 c3 e8 4c fc ff ff 48 89 03 48 8b 05 12 f7 20 00 48 c7 43 08 00 00 00 00 48 89 43 10 48 89 18 48 83 c3 08 48 8b 05 90 f6 20 00 48 89 1d f1 f6 20 00 48 85 c0 } //1
		$a_01_1 = {31 c0 be 59 bb 40 00 bf d8 b9 40 00 e8 44 1c 00 00 be 92 ba 40 00 bf 66 bb 40 00 e8 75 f9 ff ff 48 85 c0 48 89 c3 74 ae 80 3d 56 f5 20 00 00 75 a5 0f b7 15 ad f5 20 00 48 8b 3d 9e f5 20 00 48 89 c1 be 01 00 00 00 e8 79 fc ff ff 48 89 df e8 f1 fb ff ff eb 80 be e8 03 00 00 bf 01 00 00 00 45 31 ed } //1
		$a_01_2 = {48 89 ea 44 89 e6 bf a0 15 61 00 66 89 05 ce f7 20 00 e8 19 39 00 00 80 3d c4 f7 20 00 00 0f 85 2d 02 00 00 bf a0 15 61 00 e8 a2 20 00 00 48 8b 7d 00 be 2f 00 00 00 e8 74 fc ff ff 4c 8d 68 01 bf 19 bb 40 00 31 c0 4c 89 ee e8 31 24 00 00 31 c0 bf 2a bb 40 00 } //1
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1) >=3
 
}